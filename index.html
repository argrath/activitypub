<!DOCTYPE html><html dir="ltr" lang="en"><head><meta charset="utf-8"><meta name="generator" content="ReSpec 19.0.1"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><style>/* --- EXAMPLES --- */
div.example-title {
    min-width: 7.5em;
    color: #b9ab2d;
}
div.example-title span {
    text-transform: uppercase;
}
aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
div.illegal-example { color: red }
div.illegal-example p { color: black }
aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    background: #fcfaee;
}

aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
}
aside.example div.example div.example-title {
    color: #999;
}
</style><style>/* --- ISSUES/NOTES --- */
div.issue-title, div.note-title , div.ednote-title, div.warning-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
}
div.issue-title { color: #e05252; }
div.note-title, div.ednote-title { color: #2b2; }
div.warning-title { color: #f22; }
div.issue-title span, div.note-title span, div.ednote-title span, div.warning-title span {
    text-transform: uppercase;
}
div.note, div.issue, div.ednote, div.warning {
    margin-top: 1em;
    margin-bottom: 1em;
}
.note > p:first-child, .ednote > p:first-child, .issue > p:first-child, .warning > p:first-child { margin-top: 0 }
.issue, .note, .ednote, .warning {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
}
div.issue, div.note , div.ednote,  div.warning {
    padding: 1em 1.2em 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
span.note, span.ednote, span.issue, span.warning { padding: .1em .5em .15em; }

.issue {
    border-color: #e05252;
    background: #fbe9e9;
}
.note, .ednote {
    border-color: #52e052;
    background: #e9fbe9;
}

.warning {
    border-color: #f11;
    border-width: .2em;
    border-style: solid;
    background: #fbe9e9;
}

.warning-title:before{
    content: "⚠"; /*U+26A0 WARNING SIGN*/
    font-size: 3em;
    float: left;
    height: 100%;
    padding-right: .3em;
    vertical-align: top;
    margin-top: -0.5em;
}

li.task-list-item {
    list-style: none;
}

input.task-list-item-checkbox {
    margin: 0 0.35em 0.25em -1.6em;
    vertical-align: middle;
}
</style>
    <title>ActivityPub</title>
    
    
    
    <style type="text/css">
      img {
          max-width: 100%;
      }
    </style>
  <style id="respec-mainstyle">/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* Override code highlighter background */
.hljs {
  background: transparent !important;
}

/* --- INLINES --- */
h1 abbr,
h2 abbr,
h3 abbr,
h4 abbr,
h5 abbr,
h6 abbr,
a abbr {
  border: none;
}

dfn {
  font-weight: bold;
}

a.internalDFN {
  color: inherit;
  border-bottom: 1px solid #99c;
  text-decoration: none;
}

a.externalDFN {
  color: inherit;
  border-bottom: 1px dotted #ccc;
  text-decoration: none;
}

a.bibref {
  text-decoration: none;
}

cite .bibref {
  font-style: normal;
}

code {
  color: #c83500;
}

th code {
  color: inherit;
}

/* --- TOC --- */

.toc a,
.tof a {
  text-decoration: none;
}

a .secno,
a .figno {
  color: #000;
}

ul.tof,
ol.tof {
  list-style: none outside none;
}

.caption {
  margin-top: 0.5em;
  font-style: italic;
}

/* --- TABLE --- */

table.simple {
  border-spacing: 0;
  border-collapse: collapse;
  border-bottom: 3px solid #005a9c;
}

.simple th {
  background: #005a9c;
  color: #fff;
  padding: 3px 5px;
  text-align: left;
}

.simple th[scope="row"] {
  background: inherit;
  color: inherit;
  border-top: 1px solid #ddd;
}

.simple td {
  padding: 3px 10px;
  border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
  background: #f0f6ff;
}

/* --- DL --- */

.section dd > p:first-child {
  margin-top: 0;
}

.section dd > p:last-child {
  margin-bottom: 0;
}

.section dd {
  margin-bottom: 1em;
}

.section dl.attrs dd,
.section dl.eldef dd {
  margin-bottom: 0;
}

#issue-summary > ul,
.respec-dfn-list {
  column-count: 2;
}

#issue-summary li,
.respec-dfn-list li {
  list-style: none;
}

details.respec-tests-details {
  margin-left: 1em;
  display: inline-block;
  vertical-align: top;
}

details.respec-tests-details > * {
  padding-right: 2em;
}

details.respec-tests-details[open] {
  z-index: 999999;
  position: absolute;
  border: thin solid #cad3e2;
  border-radius: .3em;
  background-color: white;
  padding-bottom: .5em;
}

details.respec-tests-details[open] > summary {
  border-bottom: thin solid #cad3e2;
  padding-left: 1em;
  margin-bottom: 1em;
  line-height: 2em;
}

details.respec-tests-details > ul {
  width: 100%;
  margin-top: -0.3em;
}

details.respec-tests-details > li {
  padding-left: 1em;
}

@media print {
  .removeOnSave {
    display: none;
  }
}
</style><style>/*

github.com style (c) Vasily Polovnyov <vast@whiteants.net>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  color: #333;
  background: #f8f8f8;
}

.hljs-comment,
.hljs-quote {
  color: #998;
  font-style: italic;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-subst {
  color: #333;
  font-weight: bold;
}

.hljs-number,
.hljs-literal,
.hljs-variable,
.hljs-template-variable,
.hljs-tag .hljs-attr {
  color: #008080;
}

.hljs-string,
.hljs-doctag {
  color: #d14;
}

.hljs-title,
.hljs-section,
.hljs-selector-id {
  color: #900;
  font-weight: bold;
}

.hljs-subst {
  font-weight: normal;
}

.hljs-type,
.hljs-class .hljs-title {
  color: #458;
  font-weight: bold;
}

.hljs-tag,
.hljs-name,
.hljs-attribute {
  color: #000080;
  font-weight: normal;
}

.hljs-regexp,
.hljs-link {
  color: #009926;
}

.hljs-symbol,
.hljs-bullet {
  color: #990073;
}

.hljs-built_in,
.hljs-builtin-name {
  color: #0086b3;
}

.hljs-meta {
  color: #999;
  font-weight: bold;
}

.hljs-deletion {
  background: #fdd;
}

.hljs-addition {
  background: #dfd;
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}
</style><link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/W3C-REC"><link rel="canonical" href="https://www.w3.org/TR/activitypub/"><script id="initialUserConfig" type="application/json">{
  "specStatus": "REC",
  "publishDate": "2018-01-23",
  "previousPublishDate": "2017-12-05",
  "previousMaturity": "PR",
  "license": "w3c-software-doc",
  "shortName": "activitypub",
  "wg": "Social Web Working Group",
  "wgURI": "https://www.w3.org/Social/WG",
  "wgPublicList": "public-socialweb",
  "wgPatentURI": "https://www.w3.org/2004/01/pp-impl/72531/status",
  "edDraftURI": "https://w3c.github.io/activitypub/",
  "testSuiteURI": "https://test.activitypub.rocks/",
  "errata": "https://www.w3.org/wiki/ActivityPub_errata",
  "implementationReportURI": "https://activitypub.rocks/implementation-report",
  "otherLinks": [
    {
      "key": "Repository",
      "data": [
        {
          "value": "Git repository",
          "href": "https://github.com/w3c/activitypub"
        },
        {
          "value": "Issues",
          "href": "https://github.com/w3c/activitypub/issues"
        },
        {
          "value": "Commits",
          "href": "https://github.com/w3c/activitypub/commits/gh-pages"
        }
      ]
    }
  ],
  "editors": [
    {
      "name": "Christine Lemmer-Webber",
      "url": "https://dustycloud.org/",
      "w3cid": "57007"
    },
    {
      "name": "Jessica Tallon",
      "url": "https://tsyesika.se",
      "w3cid": "72695"
    }
  ],
  "authors": [
    {
      "name": "Christine Lemmer-Webber",
      "url": "https://dustycloud.org/"
    },
    {
      "name": "Jessica Tallon",
      "url": "https://tsyesika.se"
    },
    {
      "name": "Erin Shepherd",
      "url": "http://erinshepherd.net/"
    },
    {
      "name": "Amy Guy",
      "url": "https://rhiaro.co.uk/"
    },
    {
      "name": "Evan Prodromou",
      "url": "https://en.wikipedia.org/wiki/Evan_Prodromou"
    }
  ],
  "localBiblio": {
    "ActivityStreams": {
      "title": "Activity Streams 2.0",
      "href": "https://www.w3.org/TR/activitystreams-core/",
      "authors": [
        "J. Snell"
      ],
      "status": "Editors Draft",
      "publisher": "ActivityStreams Working Group"
    },
    "Activity-Vocabulary": {
      "title": "Activity Vocabulary",
      "href": "https://www.w3.org/TR/activitystreams-vocabulary/",
      "authors": [
        "J. Snell"
      ],
      "status": "Editors Draft",
      "publisher": "ActivityStreams Working Group"
    },
    "OAuth-Server-Metadata": {
      "title": "OAuth 2.0 Authorization Server Metadata",
      "href": "https://tools.ietf.org/html/draft-ietf-oauth-discovery-06",
      "authors": [
        "M. Jones",
        "N. Sakimura",
        "J. Bradley"
      ],
      "status": "Internet-Draft",
      "publisher": "OAuth Working Group"
    }
  },
  "publishISODate": "2018-01-23T00:00:00.000Z",
  "generatedSubtitle": "Recommendation 23 January 2018"
}</script><meta name="description" content="The ActivityPub protocol is a decentralized social networking protocol
        based upon the [ActivityStreams] 2.0 data format.
        It provides a client to server API for creating, updating and deleting
        content, as well as a federated server to server API for delivering
        notifications and content."></head>
  <!-- STYLISTIC NOTE: This document wraps on column 79 and at the end of every
       sentence. -->
  <body aria-busy="false" class="h-entry"><div class="head">
    <p>
      <a class="logo" href="https://www.w3.org/"><img src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" alt="W3C" width="72" height="48"></a>
    </p>
  <p><!--_hyper: 682859076;--></p>
  <h1 class="title p-name" id="title">ActivityPub</h1>
  <h2 id="w3c-recommendation-23-january-2018"><abbr title="World Wide Web Consortium">W3C</abbr> Recommendation <time class="dt-published" datetime="2018-01-23">23 January 2018</time></h2>
  <dl>
      <dt>This version:</dt>
      <dd><a class="u-url" href="https://www.w3.org/TR/2018/REC-activitypub-20180123/">https://www.w3.org/TR/2018/REC-activitypub-20180123/</a></dd>
      <dt>Latest published version:</dt>
      <dd><a href="https://www.w3.org/TR/activitypub/">https://www.w3.org/TR/activitypub/</a></dd>
      <dt>Latest editor's draft:</dt>
      <dd><a href="https://w3c.github.io/activitypub/">https://w3c.github.io/activitypub/</a></dd>
      <dt>Test suite:</dt>
      <dd><a href="https://test.activitypub.rocks/">https://test.activitypub.rocks/</a></dd>
      <dt>Implementation report:</dt>
      <dd><a href="https://activitypub.rocks/implementation-report">https://activitypub.rocks/implementation-report</a></dd>
      <dt>Previous version:</dt>
      <dd><a href="https://www.w3.org/TR/2017/PR-activitypub-20171205/">https://www.w3.org/TR/2017/PR-activitypub-20171205/</a></dd>
    <dt>Editors:</dt>
    <dd class="p-author h-card vcard" data-editor-id="57007"><a class="u-url url p-name fn" href="https://dustycloud.org/">Christine Lemmer-Webber</a></dd>
<dd class="p-author h-card vcard" data-editor-id="72695"><a class="u-url url p-name fn" href="https://tsyesika.se">Jessica Tallon</a></dd>

      <dt>Authors:</dt>
      <dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="https://dustycloud.org/">Christine Lemmer-Webber</a></dd>
<dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="https://tsyesika.se">Jessica Tallon</a></dd>
<dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="http://erinshepherd.net/">Erin Shepherd</a></dd>
<dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="https://rhiaro.co.uk/">Amy Guy</a></dd>
<dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="https://en.wikipedia.org/wiki/Evan_Prodromou">Evan Prodromou</a></dd>

          <dt>Repository:</dt>
                  <dd>
                    <a href="https://github.com/w3c/activitypub">
                      Git repository
                    </a>
                  </dd>
                  <dd>
                    <a href="https://github.com/w3c/activitypub/issues">
                      Issues
                    </a>
                  </dd>
                  <dd>
                    <a href="https://github.com/w3c/activitypub/commits/gh-pages">
                      Commits
                    </a>
                  </dd>
  </dl>
    <p>
      Please check the <a href="https://www.w3.org/wiki/ActivityPub_errata"><strong>errata</strong></a> for any errors or issues
      reported since publication.
    </p>
    <p>
      See also <a href="http://www.w3.org/2003/03/Translations/byTechnology?technology=activitypub">
      <strong>translations</strong></a>.
    </p>
      <p class="copyright">
        <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> ©
        2018
        
        <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
        (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
        <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
        <a href="https://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>).
        <abbr title="World Wide Web Consortium">W3C</abbr> <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
        <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
            <a rel="license" href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document">permissive document license</a>
        rules apply.
      </p>
  <hr title="Separator for header">
</div>
    <section id="abstract" class="introductory"><h2 id="abstract-0">Abstract</h2>
      <p>
        The ActivityPub protocol is a decentralized social networking protocol
        based upon the [<cite><a class="bibref" href="#bib-ActivityStreams">ActivityStreams</a></cite>] 2.0 data format.
        It provides a client to server API for creating, updating and deleting
        content, as well as a federated server to server API for delivering
        notifications and content.
      </p>
    </section>

    <section id="sotd" class="introductory"><h2 id="status-of-this-document">Status of This Document</h2>
      <p>
        <em>This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this technical report can be found in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at https://www.w3.org/TR/.</em>
      </p>
        
    
        <p>
          This document was published by the <a href="https://www.w3.org/Social/WG">Social Web Working Group</a> as a Recommendation.
        </p>
        <p>
          All interested parties are invited to provide implementation and bug
          reports and other comments through the Working Group's
          <a href="https://github.com/w3c/activitypub/issues">Issue tracker</a>.
          These will be discussed by the
          <a href="http://www.w3.org/wiki/SocialCG">Social Web Community Group</a>
          and considered in any future versions of this specification.
        </p>
          <p>
            Please see the Working Group's  <a href="https://activitypub.rocks/implementation-report">implementation
            report</a>.
          </p>
          <p>
            This document has been reviewed by <abbr title="World Wide Web Consortium">W3C</abbr> Members, by software developers, and by other <abbr title="World Wide Web Consortium">W3C</abbr>
            groups and interested parties, and is endorsed by the Director as a <abbr title="World Wide Web Consortium">W3C</abbr> Recommendation.
            It is a stable document and may be used as reference material or cited from another
            document. <abbr title="World Wide Web Consortium">W3C</abbr>'s role in making the Recommendation is to draw attention to the
            specification and to promote its widespread deployment. This enhances the functionality
            and interoperability of the Web.
          </p>
        <p>
            This document was produced by
            a group
             operating under the
            <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
              <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="https://www.w3.org/2004/01/pp-impl/72531/status" rel="disclosure">public list of any patent
              disclosures</a>
            made in connection with the deliverables of
            the group; that page also includes
            instructions for disclosing a patent. An individual who has actual knowledge of a patent
            which the individual believes contains
            <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential
            Claim(s)</a> must disclose the information in accordance with
            <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section
            6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
        </p>
          <p>This document is governed by the <a id="w3c_process_revision" href="https://www.w3.org/2017/Process-20170301/">1 March 2017 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
          </p>
        

</section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a href="#Overview" class="tocxref"><span class="secno">1. </span>Overview</a><ol class="toc"><li class="tocline"><a href="#social-web-working-group" class="tocxref"><span class="secno">1.1 </span>Social Web Working Group</a></li></ol></li><li class="tocline"><a href="#conformance" class="tocxref"><span class="secno">2. </span>Conformance</a><ol class="toc"><li class="tocline"><a href="#specification-profiles" class="tocxref"><span class="secno">2.1 </span>Specification Profiles</a></li></ol></li><li class="tocline"><a href="#obj" class="tocxref"><span class="secno">3. </span>Objects</a><ol class="toc"><li class="tocline"><a href="#obj-id" class="tocxref"><span class="secno">3.1 </span>Object Identifiers</a></li><li class="tocline"><a href="#retrieving-objects" class="tocxref"><span class="secno">3.2 </span>Retrieving objects</a></li><li class="tocline"><a href="#source-property" class="tocxref"><span class="secno">3.3 </span>The source property</a></li></ol></li><li class="tocline"><a href="#actors" class="tocxref"><span class="secno">4. </span>Actors</a><ol class="toc"><li class="tocline"><a href="#actor-objects" class="tocxref"><span class="secno">4.1 </span><i>Actor</i> objects</a></li></ol></li><li class="tocline"><a href="#collections" class="tocxref"><span class="secno">5. </span>Collections</a><ol class="toc"><li class="tocline"><a href="#outbox" class="tocxref"><span class="secno">5.1 </span>Outbox</a></li><li class="tocline"><a href="#inbox" class="tocxref"><span class="secno">5.2 </span>Inbox</a></li><li class="tocline"><a href="#followers" class="tocxref"><span class="secno">5.3 </span>Followers Collection</a></li><li class="tocline"><a href="#following" class="tocxref"><span class="secno">5.4 </span>Following Collection</a></li><li class="tocline"><a href="#liked" class="tocxref"><span class="secno">5.5 </span>Liked Collection</a></li><li class="tocline"><a href="#public-addressing" class="tocxref"><span class="secno">5.6 </span>Public Addressing</a></li><li class="tocline"><a href="#likes" class="tocxref"><span class="secno">5.7 </span>Likes Collection</a></li><li class="tocline"><a href="#shares" class="tocxref"><span class="secno">5.8 </span>Shares Collection</a></li></ol></li><li class="tocline"><a href="#client-to-server-interactions" class="tocxref"><span class="secno">6. </span>Client to Server Interactions</a><ol class="toc"><li class="tocline"><a href="#client-addressing" class="tocxref"><span class="secno">6.1 </span>Client Addressing</a></li><li class="tocline"><a href="#create-activity-outbox" class="tocxref"><span class="secno">6.2 </span>Create Activity</a><ol class="toc"><li class="tocline"><a href="#object-without-create" class="tocxref"><span class="secno">6.2.1 </span>Object creation without a Create Activity</a></li></ol></li><li class="tocline"><a href="#update-activity-outbox" class="tocxref"><span class="secno">6.3 </span>Update Activity</a><ol class="toc"><li class="tocline"><a href="#partial-updates" class="tocxref"><span class="secno">6.3.1 </span>Partial Updates</a></li></ol></li><li class="tocline"><a href="#delete-activity-outbox" class="tocxref"><span class="secno">6.4 </span>Delete Activity</a></li><li class="tocline"><a href="#follow-activity-outbox" class="tocxref"><span class="secno">6.5 </span>Follow Activity</a></li><li class="tocline"><a href="#add-activity-outbox" class="tocxref"><span class="secno">6.6 </span>Add Activity</a></li><li class="tocline"><a href="#remove-activity-outbox" class="tocxref"><span class="secno">6.7 </span>Remove Activity</a></li><li class="tocline"><a href="#like-activity-outbox" class="tocxref"><span class="secno">6.8 </span>Like Activity</a></li><li class="tocline"><a href="#block-activity-outbox" class="tocxref"><span class="secno">6.9 </span>Block Activity</a></li><li class="tocline"><a href="#undo-activity-outbox" class="tocxref"><span class="secno">6.10 </span>Undo Activity</a></li><li class="tocline"><a href="#client-to-server-outbox-delivery" class="tocxref"><span class="secno">6.11 </span>Delivery</a></li><li class="tocline"><a href="#uploading-media" class="tocxref"><span class="secno">6.12 </span>Uploading Media</a></li></ol></li><li class="tocline"><a href="#server-to-server-interactions" class="tocxref"><span class="secno">7. </span>Server to Server Interactions</a><ol class="toc"><li class="tocline"><a href="#delivery" class="tocxref"><span class="secno">7.1 </span>Delivery</a><ol class="toc"><li class="tocline"><a href="#outbox-delivery" class="tocxref"><span class="secno">7.1.1 </span>Outbox Delivery Requirements for Server to Server</a></li><li class="tocline"><a href="#inbox-forwarding" class="tocxref"><span class="secno">7.1.2 </span>Forwarding from Inbox</a></li><li class="tocline"><a href="#shared-inbox-delivery" class="tocxref"><span class="secno">7.1.3 </span>Shared Inbox Delivery</a></li></ol></li><li class="tocline"><a href="#create-activity-inbox" class="tocxref"><span class="secno">7.2 </span>Create Activity</a></li><li class="tocline"><a href="#update-activity-inbox" class="tocxref"><span class="secno">7.3 </span>Update Activity</a></li><li class="tocline"><a href="#delete-activity-inbox" class="tocxref"><span class="secno">7.4 </span>Delete Activity</a></li><li class="tocline"><a href="#follow-activity-inbox" class="tocxref"><span class="secno">7.5 </span>Follow Activity</a></li><li class="tocline"><a href="#accept-activity-inbox" class="tocxref"><span class="secno">7.6 </span>Accept Activity</a></li><li class="tocline"><a href="#reject-activity-inbox" class="tocxref"><span class="secno">7.7 </span>Reject Activity</a></li><li class="tocline"><a href="#add-activity-inbox" class="tocxref"><span class="secno">7.8 </span>Add Activity</a></li><li class="tocline"><a href="#remove-activity-inbox" class="tocxref"><span class="secno">7.9 </span>Remove Activity</a></li><li class="tocline"><a href="#like-activity-inbox" class="tocxref"><span class="secno">7.10 </span>Like Activity</a></li><li class="tocline"><a href="#announce-activity-inbox" class="tocxref"><span class="secno">7.11 </span>Announce Activity (sharing)</a></li><li class="tocline"><a href="#undo-activity-inbox" class="tocxref"><span class="secno">7.12 </span>Undo Activity</a></li></ol></li><li class="tocline"><a href="#i18n-concerns" class="tocxref"><span class="secno">A. </span>Internationalization</a></li><li class="tocline"><a href="#security-considerations" class="tocxref"><span class="secno">B. </span>Security Considerations</a><ol class="toc"><li class="tocline"><a href="#authorization" class="tocxref"><span class="secno">B.1 </span>Authentication and Authorization</a></li><li class="tocline"><a href="#security-verification" class="tocxref"><span class="secno">B.2 </span>Verification</a></li><li class="tocline"><a href="#security-localhost" class="tocxref"><span class="secno">B.3 </span>Accessing localhost URIs</a></li><li class="tocline"><a href="#security-uri-schemes" class="tocxref"><span class="secno">B.4 </span>URI Schemes</a></li><li class="tocline"><a href="#security-recursive-objects" class="tocxref"><span class="secno">B.5 </span>Recursive Objects</a></li><li class="tocline"><a href="#security-spam" class="tocxref"><span class="secno">B.6 </span>Spam</a></li><li class="tocline"><a href="#security-federation-dos" class="tocxref"><span class="secno">B.7 </span>Federation denial-of-service</a></li><li class="tocline"><a href="#security-c2s-ratelimiting" class="tocxref"><span class="secno">B.8 </span>Client-to-server ratelimiting</a></li><li class="tocline"><a href="#security-c2s-response-dos" class="tocxref"><span class="secno">B.9 </span>Client-to-server response denial-of-service</a></li><li class="tocline"><a href="#security-sanitizing-content" class="tocxref"><span class="secno">B.10 </span>Sanitizing Content</a></li><li class="tocline"><a href="#security-not-displaying-bto-bcc" class="tocxref"><span class="secno">B.11 </span>Not displaying bto and bcc properties</a></li></ol></li><li class="tocline"><a href="#acknowledgements" class="tocxref"><span class="secno">C. </span>Acknowledgements</a></li><li class="tocline"><a href="#references" class="tocxref"><span class="secno">D. </span>References</a><ol class="toc"><li class="tocline"><a href="#normative-references" class="tocxref"><span class="secno">D.1 </span>Normative references</a></li><li class="tocline"><a href="#informative-references" class="tocxref"><span class="secno">D.2 </span>Informative references</a></li></ol></li></ol></nav>

    <section id="Overview">
      <!--OddPage--><h2 id="x1-overview"><span class="secno">1. </span>Overview</h2>

      <p>ActivityPub provides two layers:</p>

      <ul>
        <li>
          <b>A server to server federation protocol</b>
          (so decentralized websites can share information)
        </li>
        <li>
          <b>A client to server protocol</b>
          (so users, including real-world users, bots, and other automated processes,
          can communicate with ActivityPub using their accounts on servers,
          from a phone or desktop or web application or whatever)
        </li>
      </ul>

      <p>
        ActivityPub implementations can implement just one of these things or
        both of them.
        However, once you've implemented one, it isn't too many steps to
        implement the other, and there are a lot of benefits to both (making
        your website part of the decentralized social web, and being able to
        use clients and client libraries that work across a wide variety of
        social websites).
      </p>

      <p>
        In ActivityPub, a user is represented by "<a href="#actors">actors</a>"
        via the user's accounts on servers.
        User's accounts on different servers correspond to different actors.
        Every Actor has:
      </p>

      <ul>
        <li><b>An <code>inbox</code>:</b>  How they get messages from the world</li>
        <li><b>An <code>outbox</code>:</b> How they send messages to others</li>
      </ul>

      <p>
        <img src="illustration/tutorial-1.png" alt="Actor with inbox and outbox">
      </p>

      <p>
        These are endpoints, or really, just URLs which are listed in the
        ActivityPub actor's ActivityStreams description.
        (More on ActivityStreams later).
      </p>

      <p>
        Here's an example of the record of our friend Alyssa P. Hacker:
      </p>

      <div class="example"><div class="example-title marker"><span>Example 1</span></div><pre class="highlight json hljs" aria-busy="false" aria-live="polite">{<span class="hljs-attr">"@context"</span>: <span class="hljs-string">"https://www.w3.org/ns/activitystreams"</span>,
 <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Person"</span>,
 <span class="hljs-attr">"id"</span>: <span class="hljs-string">"https://social.example/alyssa/"</span>,
 <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Alyssa P. Hacker"</span>,
 <span class="hljs-attr">"preferredUsername"</span>: <span class="hljs-string">"alyssa"</span>,
 <span class="hljs-attr">"summary"</span>: <span class="hljs-string">"Lisp enthusiast hailing from MIT"</span>,
 <span class="hljs-attr">"inbox"</span>: <span class="hljs-string">"https://social.example/alyssa/inbox/"</span>,
 <span class="hljs-attr">"outbox"</span>: <span class="hljs-string">"https://social.example/alyssa/outbox/"</span>,
 <span class="hljs-attr">"followers"</span>: <span class="hljs-string">"https://social.example/alyssa/followers/"</span>,
 <span class="hljs-attr">"following"</span>: <span class="hljs-string">"https://social.example/alyssa/following/"</span>,
 <span class="hljs-attr">"liked"</span>: <span class="hljs-string">"https://social.example/alyssa/liked/"</span>}</pre></div>

      <p>
        ActivityPub uses [<cite><a class="bibref" href="#bib-ActivityStreams">ActivityStreams</a></cite>] for its vocabulary.
        This is pretty great because ActivityStreams includes all the common
        terms you need to represent all the activities and content flowing
        around a social network.
        It's likely that ActivityStreams already includes all the vocabulary
        you need, but even if it doesn't, ActivityStreams can be extended
        via [<cite><a class="bibref" href="#bib-JSON-LD">JSON-LD</a></cite>].
        If you know what JSON-LD is, you can take advantage of the cool linked
        data approaches provided by JSON-LD.
        If you don't, don't worry, JSON-LD documents and ActivityStreams can be
        understood as plain old simple JSON.
        (If you're going to add extensions, that's the point at which JSON-LD
        really helps you out).
      </p>

      <p>
        So, okay.
        Alyssa wants to talk to her friends, and her friends want to talk to
        her!
        Luckily these "inbox" and "outbox" things can help us out.
        They both behave differently for GET and POST.
        Let's see how that works:
      </p>

      <p>
        <img src="illustration/tutorial-2.png" alt="Actor with messages flowing from rest of world to inbox and from outbox to rest of world">
      </p>

      <p>
        Hey nice, so just as a recap:
      </p>

      <ul>
        <li>
          You can POST to someone's inbox to send them a message
          (server-to-server / federation only... this <em>is</em> federation!)
        </li>
        <li>
          You can GET from your inbox to read your latest messages
          (client-to-server; this is like reading your social
          network stream)
        </li>
        <li>
          You can POST to your outbox to send messages to the world
          (client-to-server)
        </li>
        <li>
          You can GET from someone's outbox to see what messages they've
          posted (or at least the ones you're authorized to see).
          (client-to-server and/or server-to-server)
        </li>
      </ul>
 
      <p>
        Of course, if that last one (GET'ing from someone's outbox) was the
        only way to see what people have sent, this wouldn't be a very
        efficient federation protocol!
        Indeed, federation happens usually by servers posting messages sent by
        actors to actors on other servers' inboxes.
      </p>

      <p>
        Let's see an example!
        Let's say Alyssa wants to catch up with her friend, Ben Bitdiddle.
        She lent him a book recently and she wants to make sure he returns it
        to her.
        Here's the message she composes, as an ActivityStreams object:
      </p>

      <div class="example"><div class="example-title marker"><span>Example 2</span></div><pre class="highlight json hljs" aria-busy="false" aria-live="polite">{<span class="hljs-attr">"@context"</span>: <span class="hljs-string">"https://www.w3.org/ns/activitystreams"</span>,
 <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Note"</span>,
 <span class="hljs-attr">"to"</span>: [<span class="hljs-string">"https://chatty.example/ben/"</span>],
 <span class="hljs-attr">"attributedTo"</span>: <span class="hljs-string">"https://social.example/alyssa/"</span>,
 <span class="hljs-attr">"content"</span>: <span class="hljs-string">"Say, did you finish reading that book I lent you?"</span>}</pre></div>

      <p>
        This is a note addressed to Ben.
        She POSTs it to her outbox.
      </p>

      <p>
        <img src="illustration/tutorial-3.png" alt="Actor posting message to outbox">
      </p>

      <p>
        Since this is a non-activity object, the server recognizes that this is
        an object being newly created, and does the courtesy of wrapping it in
        a Create activity.
        (Activities sent around in ActivityPub generally follow the pattern of
        some activity by some actor being taken on some object.
        In this case the activity is a Create of a Note object, posted by a
        Person).
      </p>


      <div class="example"><div class="example-title marker"><span>Example 3</span></div><pre class="highlight json hljs" aria-busy="false" aria-live="polite">{<span class="hljs-attr">"@context"</span>: <span class="hljs-string">"https://www.w3.org/ns/activitystreams"</span>,
 <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Create"</span>,
 <span class="hljs-attr">"id"</span>: <span class="hljs-string">"https://social.example/alyssa/posts/a29a6843-9feb-4c74-a7f7-081b9c9201d3"</span>,
 <span class="hljs-attr">"to"</span>: [<span class="hljs-string">"https://chatty.example/ben/"</span>],
 <span class="hljs-attr">"actor"</span>: <span class="hljs-string">"https://social.example/alyssa/"</span>,
 <span class="hljs-attr">"object"</span>: {<span class="hljs-attr">"type"</span>: <span class="hljs-string">"Note"</span>,
            <span class="hljs-attr">"id"</span>: <span class="hljs-string">"https://social.example/alyssa/posts/49e2d03d-b53a-4c4c-a95c-94a6abf45a19"</span>,
            <span class="hljs-attr">"attributedTo"</span>: <span class="hljs-string">"https://social.example/alyssa/"</span>,
            <span class="hljs-attr">"to"</span>: [<span class="hljs-string">"https://chatty.example/ben/"</span>],
            <span class="hljs-attr">"content"</span>: <span class="hljs-string">"Say, did you finish reading that book I lent you?"</span>}}</pre></div>

      <p>
        Alyssa's server looks up Ben's ActivityStreams actor object, finds his
        inbox endpoint, and POSTs her object to his inbox.
      </p>

      <p>
        <img src="illustration/tutorial-4.png" alt="Server posting to remote actor's inbox">
      </p>

      <p>
        Technically these are two separate steps... one is client to server
        communication, and one is server to server communication (federation).
        But, since we're using them both in this example, we can abstractly
        think of this as being a streamlined submission from outbox to inbox:
      </p>

      <p>
        <img src="illustration/tutorial-5.png" alt="Note flowing from one actor's outbox to other actor's inbox">
      </p>

      <p>
        Cool!
        A while later, Alyssa checks what new messages she's gotten.
        Her phone polls her inbox via GET, and amongst a bunch of cat videos
        posted by friends and photos of her nephew posted by her sister, she
        sees the following:
      </p>

      <div class="example"><div class="example-title marker"><span>Example 4</span></div><pre class="highlight json hljs" aria-busy="false" aria-live="polite">{"@context": "https://www.w3.org/ns/activitystreams",
 "type": "Create",
 "id": "https://chatty.example/ben/p/51086",
 "to": ["https://social.example/alyssa/"],
 "actor": "https://chatty.example/ben/",
 "object": {"type": "Note",
            "id": "https://chatty.example/ben/p/51085",
            "attributedTo": "https://chatty.example/ben/",
            "to": ["https://social.example/alyssa/"],
            "inReplyTo": "https://social.example/alyssa/posts/49e2d03d-b53a-4c4c-a95c-94a6abf45a19",
            "content": "&lt;p&gt;Argh, yeah, sorry, I'll get it back to you tomorrow.&lt;/p&gt;
                        &lt;p&gt;I was reviewing the section on register machines,
                           since it's been a while since I wrote one.&lt;/p&gt;"}}</pre></div>

      <p>Alyssa is relieved, and likes Ben's post:</p>

      <div class="example"><div class="example-title marker"><span>Example 5</span></div><pre class="highlight json hljs" aria-busy="false" aria-live="polite">{<span class="hljs-attr">"@context"</span>: <span class="hljs-string">"https://www.w3.org/ns/activitystreams"</span>,
 <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Like"</span>,
 <span class="hljs-attr">"id"</span>: <span class="hljs-string">"https://social.example/alyssa/posts/5312e10e-5110-42e5-a09b-934882b3ecec"</span>,
 <span class="hljs-attr">"to"</span>: [<span class="hljs-string">"https://chatty.example/ben/"</span>],
 <span class="hljs-attr">"actor"</span>: <span class="hljs-string">"https://social.example/alyssa/"</span>,
 <span class="hljs-attr">"object"</span>: <span class="hljs-string">"https://chatty.example/ben/p/51086"</span>}</pre></div>

      <p>
        She POSTs this message to her outbox.
        (Since it's an activity, her server knows it doesn't need to wrap it in
        a Create object).
      </p>

      <p>
        Feeling happy about things, she decides to post a public message to her
        followers.
        Soon the following message is blasted to all the members of her
        followers collection, and since it has the special Public group
        addressed, is generally readable by anyone.
      </p>

      <div class="example"><div class="example-title marker"><span>Example 6</span></div><pre class="highlight json hljs" aria-busy="false" aria-live="polite">{<span class="hljs-attr">"@context"</span>: <span class="hljs-string">"https://www.w3.org/ns/activitystreams"</span>,
 <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Create"</span>,
 <span class="hljs-attr">"id"</span>: <span class="hljs-string">"https://social.example/alyssa/posts/9282e9cc-14d0-42b3-a758-d6aeca6c876b"</span>,
 <span class="hljs-attr">"to"</span>: [<span class="hljs-string">"https://social.example/alyssa/followers/"</span>,
        <span class="hljs-string">"https://www.w3.org/ns/activitystreams#Public"</span>],
 <span class="hljs-attr">"actor"</span>: <span class="hljs-string">"https://social.example/alyssa/"</span>,
 <span class="hljs-attr">"object"</span>: {<span class="hljs-attr">"type"</span>: <span class="hljs-string">"Note"</span>,
            <span class="hljs-attr">"id"</span>: <span class="hljs-string">"https://social.example/alyssa/posts/d18c55d4-8a63-4181-9745-4e6cf7938fa1"</span>,
            <span class="hljs-attr">"attributedTo"</span>: <span class="hljs-string">"https://social.example/alyssa/"</span>,
            <span class="hljs-attr">"to"</span>: [<span class="hljs-string">"https://social.example/alyssa/followers/"</span>,
                   <span class="hljs-string">"https://www.w3.org/ns/activitystreams#Public"</span>],
            <span class="hljs-attr">"content"</span>: <span class="hljs-string">"Lending books to friends is nice.  Getting them back is even nicer! :)"</span>}}</pre></div>

      <section id="social-web-working-group" inlist="" rel="schema:hasPart" resource="#social-web-working-group">
        <h3 property="schema:name" id="x1-1-social-web-working-group"><span class="secno">1.1 </span>Social Web Working Group</h3>
        <div datatype="rdf:HTML" property="schema:description">
          <p>
            <a href="#Overview">ActivityPub</a> is one of several related
            specifications being produced by the Social Web Working Group.
            Implementers interested in alternative approaches and complementary
            protocols should review [<cite><a class="bibref" href="#bib-Micropub">Micropub</a></cite>] and the overview document
            [<cite><a class="bibref" href="#bib-Social-Web-Protocols">Social-Web-Protocols</a></cite>].
          </p>
        </div>
      </section>
    </section>

    <section id="conformance"><!--OddPage--><h2 id="x2-conformance"><span class="secno">2. </span>Conformance</h2>
<p>
  As well as sections marked as non-normative, all authoring guidelines, diagrams, examples,
  and notes in this specification are non-normative. Everything else in this specification is
  normative.
</p>
<p id="respecRFC2119">The key words  <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, <em class="rfc2119">SHOULD</em>, and <em class="rfc2119">SHOULD NOT</em> are 
  to be interpreted as described in [<cite><a class="bibref" href="#bib-RFC2119">RFC2119</a></cite>].
</p>

      <section id="specification-profiles">
        <h3 id="x2-1-specification-profiles"><span class="secno">2.1 </span>Specification Profiles</h3>
        <p>
          This specification defines two closely related and interacting
          protocols:
        </p>
        <dl>
          <dt>A client to server protocol, or "Social API"</dt>
          <dd>
            This protocol permits a client to act <i>on behalf</i> of a user.
            For example, this protocol is used by a mobile phone application to
            interact with a social stream of the user's actor.
          </dd>
          <dt>A server to server protocol, or "Federation Protocol"</dt>
          <dd>
            This protocol is used to distribute activities between actors on
            different servers, tying them into the same social graph.
          </dd>
        </dl>
        <p>
          The ActivityPub specification is designed so that once either of
          these protocols are implemented, supporting the other is of very
          little additional effort.
          However, servers may still implement one without the other.
          This gives three conformance classes:
        </p>
        <dl>
          <dt>ActivityPub conformant Client</dt>
          <dd>
            This designation applies to any implementation of the entirety of the
            client portion of the client to server protocol.
          </dd>
          <dt>ActivityPub conformant Server</dt>
          <dd>
            This designation applies to any implementation of the entirety of the
            server portion of the client to server protocol.
          </dd>
          <dt>ActivityPub conformant Federated Server</dt>
          <dd>
            This designation applies to any implementation of the entirety of
            the federation protocols.
          </dd>
        </dl>
        <p>
          It is called out whenever a portion of the specification only applies
          to implementation of the federation protocol.
          In addition, whenever requirements are specified, it is called out
          whether they apply to the client or server (for the client-to-server
          protocol) or whether referring to a sending or receiving server in
          the server-to-server protocol.
        </p>
      </section>
    </section>

    <section id="obj">
      <!--OddPage--><h2 id="x3-objects"><span class="secno">3. </span>Objects</h2>
      <p>
        Objects are the core concept around which both [<cite><a class="bibref" href="#bib-ActivityStreams">ActivityStreams</a></cite>] and
        ActivityPub are built.
        Objects are often wrapped in Activities and are contained in streams of
        Collections, which are themselves subclasses of Objects.
        See the [<cite><a class="bibref" href="#bib-Activity-Vocabulary">Activity-Vocabulary</a></cite>] document, particularly the
        <a href="https://www.w3.org/TR/activitystreams-vocabulary/#types">Core Classes</a>;
        ActivityPub follows the mapping of this vocabulary very closely.
      </p>
      <p>
        ActivityPub defines some terms in addition to those provided by
        ActivityStreams.
        These terms are provided in the ActivityPub
        <a href="http://www.w3.org/TR/json-ld/#the-context">JSON-LD context</a>
        at
        <code>https://www.w3.org/ns/activitystreams</code>.
        Implementers <em class="rfc2119" title="SHOULD">SHOULD</em> include the ActivityPub context in their
        object definitions.
        Implementers <em class="rfc2119" title="MAY">MAY</em> include additional context as appropriate.
      </p>
      <p>
        ActivityPub shares the same
        <a href="https://www.w3.org/TR/activitystreams-core/#urls">
          URI / IRI conventions as in ActivityStreams</a>.
      </p>
      <p>
        Servers <em class="rfc2119" title="SHOULD">SHOULD</em> validate the content they receive to avoid content
        spoofing attacks.
        (A server should do something at least as robust as checking that
        the object appears as received at its origin, but mechanisms
        such as checking signatures would be better if available).
        No particular mechanism for verification is authoritatively specified by
        this document, but please see <a href="#security-considerations">Security 
        Considerations</a> for some suggestions and good practices.
      </p>
      <div class="informative">
        As an example, if example.com receives the activity
        <div class="example"><div class="example-title marker"><span>Example 7</span></div><pre class="hljs json" aria-busy="false" aria-live="polite">{
  <span class="hljs-attr">"@context"</span>: <span class="hljs-string">"https://www.w3.org/ns/activitystreams"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Like"</span>,
  <span class="hljs-attr">"actor"</span>: <span class="hljs-string">"https://example.net/~mallory"</span>,
  <span class="hljs-attr">"to"</span>: [<span class="hljs-string">"https://hatchat.example/sarah/"</span>,
         <span class="hljs-string">"https://example.com/peeps/john/"</span>],
  <span class="hljs-attr">"object"</span>: {
    <span class="hljs-attr">"@context"</span>: {<span class="hljs-attr">"@language"</span>: <span class="hljs-string">"en"</span>},
    <span class="hljs-attr">"id"</span>: <span class="hljs-string">"https://example.org/~alice/note/23"</span>,
    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Note"</span>,
    <span class="hljs-attr">"attributedTo"</span>: <span class="hljs-string">"https://example.org/~alice"</span>,
    <span class="hljs-attr">"content"</span>: <span class="hljs-string">"I'm a goat"</span>
  }
}</pre></div>
        it should dereference the <code>id</code> both to ensure that it exists
        and is a valid object, and that it is not misrepresenting the object.
        (In this example, Mallory could be spoofing an object allegedly posted
        by Alice).
      </div>
      <section id="obj-id">
        <h3 id="x3-1-object-identifiers"><span class="secno">3.1 </span>Object Identifiers</h3>
        <p>
          All Objects in [<cite><a class="bibref" href="#bib-ActivityStreams">ActivityStreams</a></cite>] should have unique global
          identifiers.
          ActivityPub extends this requirement; all objects distributed by the
          ActivityPub protocol <em class="rfc2119" title="MUST">MUST</em> have unique global identifiers, unless they
          are intentionally transient (short lived activities that are not
          intended to be able to be looked up, such as some kinds of chat
          messages or game notifications).
          These identifiers must fall into one of the following groups:
        </p>
        <ol>
          <li>
            Publicly dereferencable URIs, such as HTTPS URIs, with their
            authority belonging to that of their originating server.
            (Publicly facing content <em class="rfc2119" title="SHOULD">SHOULD</em> use HTTPS URIs).
          </li>
          <li>
            An ID explicitly specified as the JSON <code>null</code> object,
            which implies an anonymous object (a part of its parent context)
          </li>
        </ol>
        <p>
          Identifiers <em class="rfc2119" title="MUST">MUST</em> be provided for activities posted in server to
          server communication, unless the activity is intentionally transient.
          However, for client to server communication, a server receiving an
          object posted to the outbox with no specified <code>id</code> <em class="rfc2119" title="SHOULD">SHOULD</em>
          allocate an object ID in the actor's namespace and attach it to the
          posted object.
        </p>
        <p>All objects have the following properties:</p>
        <dl>
          <dt>id</dt>
          <dd>
            The object's unique global identifier (unless the object is transient,
            in which case the <code>id</code> <em class="rfc2119" title="MAY">MAY</em> be omitted).
          </dd>
          <dt>type</dt>
          <dd>
            The type of the object.
          </dd>
        </dl>
      </section>

      <section id="retrieving-objects">
        <h3 id="x3-2-retrieving-objects"><span class="secno">3.2 </span>Retrieving objects</h3>
        <p>
          The HTTP GET method may be dereferenced against an object's
          <code>id</code> property to retrieve the activity.
          Servers <em class="rfc2119" title="MAY">MAY</em> use HTTP content negotiation as defined in [<cite><a class="bibref" href="#bib-RFC7231">RFC7231</a></cite>] to
          select the type of data to return in response to a request,
          but <em class="rfc2119" title="MUST">MUST</em> present the ActivityStreams object representation
          in response to
          <code>application/ld+json; profile="https://www.w3.org/ns/activitystreams"</code>,
          and <em class="rfc2119" title="SHOULD">SHOULD</em> also present the ActivityStreams representation in
          response to <code>application/activity+json</code> as well.
          The client <em class="rfc2119" title="MUST">MUST</em> specify an <code>Accept</code> header with the
          <code>application/ld+json; profile="https://www.w3.org/ns/activitystreams"</code>
          media type in order to retrieve the activity.
        </p>
        <p>
          Servers <em class="rfc2119" title="MAY">MAY</em> implement other behavior for requests which do not comply
          with the above requirement.
          (For example, servers may implement additional legacy protocols, or
          may use the same URI for both HTML and ActivityStreams
          representations of a resource).
        </p>
        <p>
          Servers <em class="rfc2119" title="MAY">MAY</em> require authorization as specified in
          <a href="#authorization" class="sec-ref"><span class="secno">B.1</span> <span class="sec-title">Authentication and Authorization</span></a>, and may additionally implement their
          own authorization rules.
          Servers <em class="rfc2119" title="SHOULD">SHOULD</em> fail requests which do not pass their authorization
          checks with the appropriate HTTP error code, or the 403 Forbidden
          error code where the existence of the object is considered private.
          An origin server which does not wish to disclose the existence of
          a private target <em class="rfc2119" title="MAY">MAY</em> instead respond with a status code of
          404 Not Found.
        </p>
      </section>

      <section id="source-property">
        <h3 id="x3-3-the-source-property"><span class="secno">3.3 </span>The source property</h3>
        <p>
          In addition to all the properties defined by the
	  [<cite><a class="bibref" href="#bib-Activity-Vocabulary">Activity-Vocabulary</a></cite>], ActivityPub extends the <code>Object</code> by
	  supplying the <code>source</code> property.
          The <code>source</code> property is intended to convey some
          sort of source from which the <code>content</code> markup
          was derived, as a form of provenance, or to support future
          editing by clients.
          In general, clients do the conversion from <code>source</code>
          to <code>content</code>, not the other way around.
        </p>
        <p>
          The value of <code>source</code> is itself an object
          which uses its own <code>content</code> and <code>mediaType</code>
          fields to supply source information.
        </p>
        <div class="example"><div class="example-title marker"><span>Example 8</span></div><pre class="hljs json" aria-busy="false" aria-live="polite">{
  <span class="hljs-attr">"@context"</span>: [<span class="hljs-string">"https://www.w3.org/ns/activitystreams"</span>,
               {<span class="hljs-attr">"@language"</span>: <span class="hljs-string">"en"</span>}],
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Note"</span>,
  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"http://postparty.example/p/2415"</span>,
  <span class="hljs-attr">"content"</span>: <span class="hljs-string">"&lt;p&gt;I &lt;em&gt;really&lt;/em&gt; like strawberries!&lt;/p&gt;"</span>,
  <span class="hljs-attr">"source"</span>: {
    <span class="hljs-attr">"content"</span>: <span class="hljs-string">"I *really* like strawberries!"</span>,
    <span class="hljs-attr">"mediaType"</span>: <span class="hljs-string">"text/markdown"</span>}
}</pre></div>
        <div class="note"><div role="heading" class="note-title marker" id="h-note" aria-level="4"><span>Note</span><span style="text-transform: none">: What to do when clients can't meaningfully handle a mediaType?</span></div><div class="">
          <p>
            In general, it's best to let a user edit their original post
            in the same source format they originally composed it in.
            But not all clients can reliably provide a nice interface for
            all source types, and since clients are expected to do the
            conversion from <code>source</code> to <code>content</code>,
            some clients may work with a media type that another client
            does not know how to work with.
            While a client could feasibly provide the <code>content</code>
            markup to be edited and ignore the source, this means that the
            user will lose the more desirable form of the original
            <code>source</code> in any future revisions.
            A client doing so should thus provide a minimally obtrusive warning
            cautioning that the original source format is not understood and is
            thus being ignored.
          </p>
          <p>
            For example, Alyssa P. Hacker likes to post to her ActivityPub
            powered blog via an Emacs client she has written, leveraging
            <a href="http://orgmode.org/">Org mode</a>.
            Later she switches to editing on her phone's client, which
            has no idea what <code>text/x-org</code> is or how to render
            it to HTML, so it provides a text box to edit the original
            <code>content</code> instead.
            A helpful warning displays above the edit area saying,
            "This was originally written in another markup language we don't
            know how to handle.  If you edit, you'll lose your original
            source!"
            Alyssa decides the small typo fix isn't worth losing her nice
            org-mode markup and decides to make the update when she gets
            home.
          </p>
        </div></div>
      </section>
    </section>

    <section id="actors">
      <!--OddPage--><h2 id="x4-actors"><span class="secno">4. </span>Actors</h2>
      <p>
        ActivityPub actors are generally one of the
        <a href="https://www.w3.org/TR/activitystreams-vocabulary/#actor-types">
          ActivityStreams Actor Types</a>,
        but they don't have to be. For example, a 
        <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-profile">
          Profile</a> object
        might be used as an actor, or a type from an ActivityStreams extension.
        Actors are <a href="#retrieving-objects">retrieved</a> like any other
        Object in ActivityPub.
        Like other ActivityStreams objects, actors have an <code>id</code>,
        which is a URI.
        When entered directly into a user interface (for example on a login
        form), it is desirable to support simplified naming.
        For this purpose, ID normalization <em class="rfc2119" title="SHOULD">SHOULD</em> be performed as follows:
      </p>
      <ol>
        <li>
          If the entered ID is a valid URI, then it is to be used directly.
        </li>
        <li>
          If it appears that the user neglected to add a scheme for a URI that
          would otherwise be considered valid, such as
          <code>example.org/alice/</code>, clients <em class="rfc2119" title="MAY">MAY</em> attempt to provide
          a default scheme, preferably <code>https</code>.
        </li>
        <li>
          Otherwise, the entered value should be considered invalid.
        </li>
      </ol>

      <p>
        Once the actor's URI has been identified, it should be dereferenced.
      </p>

      <div class="note"><div role="heading" class="note-title marker" id="h-note-0" aria-level="3"><span>Note</span></div><div class="">
        ActivityPub does not dictate a specific relationship between
        "users" and Actors; many configurations are possible.
        There may be multiple human users or organizations controlling an
        Actor, or likewise one human or organization may control multiple
        Actors. Similarly, an Actor may represent a piece of software,
        like a bot, or an automated process.
        More detailed "user" modelling, for example linking together of Actors which
        are controlled by the same entity, or allowing one Actor to be presented
        through multiple alternate profiles or aspects, are at the discretion
        of the implementation.
      </div></div>

      <section id="actor-objects">
        <h3 id="x4-1-actor-objects"><span class="secno">4.1 </span><i>Actor</i> objects</h3>
        <p>
          Actor objects <em class="rfc2119" title="MUST">MUST</em> have, in addition to the properties mandated by
          <a href="#obj-id" class="sec-ref"><span class="secno">3.1</span> <span class="sec-title">Object Identifiers</span></a>, the following properties:
        </p>
        <dl>
          <dt id="inbox-property">inbox</dt>
          <dd>
            A reference to an [<cite><a class="bibref" href="#bib-ActivityStreams">ActivityStreams</a></cite>]
            <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-orderedcollection">
              <code>OrderedCollection</code></a>
            comprised of all the messages received by the actor; see
            <a href="#inbox" class="sec-ref"><span class="secno">5.2</span> <span class="sec-title">Inbox</span></a>.
          </dd>
          <dt id="outbox-property">outbox</dt>
          <dd>
            An [<cite><a class="bibref" href="#bib-ActivityStreams">ActivityStreams</a></cite>]
            <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-orderedcollection">
              <code>OrderedCollection</code></a>
            comprised of all the messages produced by the actor; see
            <a href="#outbox" class="sec-ref"><span class="secno">5.1</span> <span class="sec-title">Outbox</span></a>.
          </dd>
        </dl>
        <p>
          Implementations <em class="rfc2119" title="SHOULD">SHOULD</em>, in addition, provide the following
          properties:
        </p>
        <dl>
          <dt id="following-property">following</dt>
          <dd>
            A link to an [<cite><a class="bibref" href="#bib-ActivityStreams">ActivityStreams</a></cite>] collection of the actors that
            this actor is following; see <a href="#following" class="sec-ref"><span class="secno">5.4</span> <span class="sec-title">Following Collection</span></a>
          </dd>
          <dt id="followers-property">followers</dt>
          <dd>
            A link to an [<cite><a class="bibref" href="#bib-ActivityStreams">ActivityStreams</a></cite>] collection of the actors that
            follow this actor; see <a href="#followers" class="sec-ref"><span class="secno">5.3</span> <span class="sec-title">Followers Collection</span></a>.
          </dd>
        </dl>
        <p>
          Implementations <em class="rfc2119" title="MAY">MAY</em> provide the following properties:
        </p>
        <dl>
          <dt id="liked-property">liked</dt>
          <dd>
            A link to an [<cite><a class="bibref" href="#bib-ActivityStreams">ActivityStreams</a></cite>] collection of objects this
            actor has liked; see <a href="#liked" class="sec-ref"><span class="secno">5.5</span> <span class="sec-title">Liked Collection</span></a>.
          </dd>
        </dl>
        <div class="example"><div class="example-title marker"><span>Example 9</span></div><pre class="hljs json" aria-busy="false" aria-live="polite">{
  <span class="hljs-attr">"@context"</span>: [<span class="hljs-string">"https://www.w3.org/ns/activitystreams"</span>,
               {<span class="hljs-attr">"@language"</span>: <span class="hljs-string">"ja"</span>}],
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Person"</span>,
  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"https://kenzoishii.example.com/"</span>,
  <span class="hljs-attr">"following"</span>: <span class="hljs-string">"https://kenzoishii.example.com/following.json"</span>,
  <span class="hljs-attr">"followers"</span>: <span class="hljs-string">"https://kenzoishii.example.com/followers.json"</span>,
  <span class="hljs-attr">"liked"</span>: <span class="hljs-string">"https://kenzoishii.example.com/liked.json"</span>,
  <span class="hljs-attr">"inbox"</span>: <span class="hljs-string">"https://kenzoishii.example.com/inbox.json"</span>,
  <span class="hljs-attr">"outbox"</span>: <span class="hljs-string">"https://kenzoishii.example.com/feed.json"</span>,
  <span class="hljs-attr">"preferredUsername"</span>: <span class="hljs-string">"kenzoishii"</span>,
  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"石井健蔵"</span>,
  <span class="hljs-attr">"summary"</span>: <span class="hljs-string">"この方はただの例です"</span>,
  <span class="hljs-attr">"icon"</span>: [
    <span class="hljs-string">"https://kenzoishii.example.com/image/165987aklre4"</span>
  ]
}</pre></div>
        <p>Implementations <em class="rfc2119" title="MAY">MAY</em>, in addition, provide the following properties:</p>
        <dl>
          <dt id="streams-property">streams</dt>
          <dd>
            A list of supplementary Collections which may be of interest.
          </dd>
          <dt id="preferredUsername">preferredUsername</dt>
          <dd>
            A short username which may be used to refer to the actor, with no
            uniqueness guarantees.
          </dd>
          <dt id="endpoints">endpoints</dt>
          <dd>
            A json object which maps additional (typically server/domain-wide)
            endpoints which may be useful either for this actor or someone
            referencing this actor.
            This mapping may be nested inside the actor document as the value
            or may be a link to a JSON-LD document with these properties.
          </dd>
        </dl>

        <p>
          The <code>endpoints</code> mapping <em class="rfc2119" title="MAY">MAY</em> include the following
          properties:
        </p>
        <dl>
          <dt id="proxyUrl">proxyUrl</dt>
          <dd>
            Endpoint URI so this actor's clients may access remote
            ActivityStreams objects which require authentication to access.
            To use this endpoint, the client posts an
            <code>x-www-form-urlencoded</code> <code>id</code> parameter
            with the value being the <code>id</code> of the requested
            ActivityStreams object.
          </dd>
          <dt id="oauthAuthorizationEndpoint">oauthAuthorizationEndpoint</dt>
          <dd>
            If OAuth 2.0 bearer tokens [<cite><a class="bibref" href="#bib-RFC6749">RFC6749</a></cite>] [<cite><a class="bibref" href="#bib-RFC6750">RFC6750</a></cite>] are being used
            for authenticating
            <a href="#client-to-server-interactions">client to server
              interactions</a>,
            this endpoint specifies a URI at which a browser-authenticated user
            may obtain a new authorization grant.
          </dd>
          <dt id="oauthTokenEndpoint">oauthTokenEndpoint</dt>
          <dd>
            If OAuth 2.0 bearer tokens [<cite><a class="bibref" href="#bib-RFC6749">RFC6749</a></cite>] [<cite><a class="bibref" href="#bib-RFC6750">RFC6750</a></cite>] are being used
            for authenticating
            <a href="#client-to-server-interactions">client to server
              interactions</a>,
            this endpoint specifies a URI at which a client may acquire an
	    access token.
          </dd>
          <dt id="provideClientKey">provideClientKey</dt>
          <dd>
            If Linked Data Signatures and HTTP Signatures are being used for
            authentication and authorization, this endpoint specifies a URI at
            which browser-authenticated users may authorize a client's public
            key for
            <a href="#client-to-server-interactions">client to server
              interactions</a>.
          </dd>
          <dt id="signClientKey">signClientKey</dt>
          <dd>
            If Linked Data Signatures and HTTP Signatures are being used for
            authentication and authorization, this endpoint specifies a URI at
            which a client key may be signed by the actor's key for a time
            window to act on behalf of the actor in interacting with foreign
            servers.
          </dd>
          <dt id="sharedInbox">sharedInbox</dt>
          <dd>
            An optional endpoint
            <a href="#shared-inbox-delivery">
              used for wide delivery of publicly addressed activities
              and activities sent to followers</a>.
            <code>sharedInbox</code> endpoints <em class="rfc2119" title="SHOULD">SHOULD</em> also be publicly
            readable <code>OrderedCollection</code> objects containing
            objects addressed to the <a href="#public-addressing">Public</a>
            special collection.
            Reading from the <code>sharedInbox</code> endpoint <em class="rfc2119" title="MUST NOT">MUST NOT</em> present
            objects which are not addressed to the <code>Public</code>
            endpoint.
          </dd>
        </dl>

        <div class="note"><div role="heading" class="note-title marker" id="h-note-1" aria-level="4"><span>Note</span></div><div class="" id="as2-actor-properties">
          <p>
            As the upstream vocabulary for ActivityPub, any applicable
            [<cite><a class="bibref" href="#bib-ActivityStreams">ActivityStreams</a></cite>] property may be used on ActivityPub Actors.
            Some ActivityStreams properties are particularly worth highlighting
            to demonstrate how they are used in ActivityPub implementations.
          </p>

          <dl>
            <dt id="url-property">url</dt>
            <dd>
              A link to the actor's "profile web page", if not equal to the
              value of <code>id</code>.
            </dd>
            <dt id="name-property">name</dt>
            <dd>
              The preferred "nickname" or "display name" of the actor.
            </dd>
            <dt id="summary-property">summary</dt>
            <dd>A quick summary or bio by the user about themselves.</dd>
            <dt id="icon-property">icon</dt>
            <dd>
              A link to an image or an Image object which represents the user's
              profile picture (this may be a thumbnail).
            </dd>
          </dl>
        </div></div>
        <div class="note"><div role="heading" class="note-title marker" id="h-note-2" aria-level="4"><span>Note</span></div><p class="" id="actor-text-direction">
          Properties containing natural language values,
          such as <code>name</code>, <code>preferredUsername</code>, or
          <code>summary</code>, make use of
          <a href="https://www.w3.org/TR/activitystreams-core/#naturalLanguageValues">
            natural language support defined in ActivityStreams</a>.
        </p></div>
      </section>

    </section>

    <section id="collections">
      <!--OddPage--><h2 id="x5-collections"><span class="secno">5. </span>Collections</h2>
      <p>
        [<cite><a class="bibref" href="#bib-ActivityStreams">ActivityStreams</a></cite>] defines the collection concept; ActivityPub
        defines several collections with special behavior.
        Note that ActivityPub makes use of
        <a href="https://www.w3.org/TR/activitystreams-core/#paging">
          ActivityStreams paging</a>
        to traverse large sets of objects.
      </p>

      <p>
        Note that some of these collections are specified to be of type
        <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-orderedcollection">
          <code>OrderedCollection</code></a>
        specifically, while others are permitted to be either a
        <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-collection">
          <code>Collection</code></a>
        or an
        <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-orderedcollection">
          <code>OrderedCollection</code></a>.
        An
        <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-orderedcollection">
          <code>OrderedCollection</code></a>
        <em class="rfc2119" title="MUST">MUST</em> be presented consistently in reverse chronological order.
      </p>

      <div class="note"><div role="heading" class="note-title marker" id="h-note-3" aria-level="3"><span>Note</span></div><p class="">
        What property is used to determine the reverse chronological order
        is intentionally left as an implementation detail.
        For example, many SQL-style databases use an incrementing integer
        as an identifier, which can be reasonably used for handling
        insertion order in most cases.
        In other databases, an insertion time timestamp may be preferred.
        What is used isn't important, but the ordering of elements must
        remain intact, with newer items first.
        A property which changes regularly, such a "last updated" timestamp,
        should not be used.
      </p></div>

      <section id="outbox">
        <h3 id="x5-1-outbox"><span class="secno">5.1 </span>Outbox</h3>
        <p>
          The outbox is discovered through the <code>outbox</code>
          property of an <a href="#actors">actor's</a> profile.
          The <code>outbox</code> <em class="rfc2119" title="MUST">MUST</em> be an
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-orderedcollection">
            <code>OrderedCollection</code></a>.
        </p>
        <p>
          The outbox stream contains activities the user has
          published, subject to the ability of the requestor to retrieve the
          activity (that is, the contents of the outbox are filtered by the
          permissions of the person reading it).
          If a user submits a request without
          <a href="#authorization">Authorization</a> the server should
          respond with all of the <a href="#public-addressing">Public</a>
          posts.
          This could potentially be all relevant objects published by the
          user, though the number of available items is left to the
          discretion of those implementing and deploying the server.
        </p>
        <p>
          The outbox accepts HTTP POST requests, with behaviour described in
          <a href="#client-to-server-interactions">Client to Server
            Interactions</a>.
        </p>
      </section>

      <section id="inbox">
        <h3 id="x5-2-inbox"><span class="secno">5.2 </span>Inbox</h3>

        <p>
          The inbox is discovered through the <code>inbox</code>
          property of an <a href="#actors">actor's</a> profile.
          The <code>inbox</code> <em class="rfc2119" title="MUST">MUST</em> be an
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-orderedcollection">
            <code>OrderedCollection</code></a>.
        </p>

        <p>
          The inbox stream contains all activities received by the
          actor.
          The server <em class="rfc2119" title="SHOULD">SHOULD</em> filter content according to the requester's
          permission.
          In general, the owner of an inbox is likely to be able to access
          all of their inbox contents. Depending on access control, some
          other content may be public, whereas other content may require
          authentication for non-owner users, if they can access the inbox
          at all.
        </p>

        <p>
          The server <em class="rfc2119" title="MUST">MUST</em> perform de-duplication of activities returned by
          the inbox. Duplication can occur if an activity is addressed both
          to an actor's followers, and a specific
          actor who also follows the recipient actor, and the server has failed
          to de-duplicate the recipients list.
          Such deduplication <em class="rfc2119" title="MUST">MUST</em> be performed by comparing the
          <code>id</code> of the activities and dropping any activities
          already seen.
        </p>

        <p>
          The inboxes of actors on federated servers accepts HTTP POST requests,
          with behaviour described in <a href="#delivery">Delivery</a>.
          Non-federated servers <em class="rfc2119" title="SHOULD">SHOULD</em> return a 405 Method Not Allowed upon
          receipt of a POST request.
        </p>
      </section>

      <section id="followers">
        <h3 id="x5-3-followers-collection"><span class="secno">5.3 </span>Followers Collection</h3>
        <p>
          Every <a href="#actors">actor</a> <em class="rfc2119" title="SHOULD">SHOULD</em> have a <code>followers</code>
          collection.
          This is a list of everyone who has sent a
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-follow">Follow</a>
          activity for the actor, added as a
          <a href="#follow-activity-outbox">side effect</a>.
          This is where one would find a list of all the actors that are
          following the actor.
          The <code>followers</code> collection <em class="rfc2119" title="MUST">MUST</em> be either an
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-orderedcollection">
            <code>OrderedCollection</code></a>
          or a
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-collection">
            <code>Collection</code></a>
          and <em class="rfc2119" title="MAY">MAY</em> be filtered on privileges of an authenticated user
          or as appropriate when no authentication is given.
        </p>

        <div class="note"><div role="heading" class="note-title marker" id="h-note-4" aria-level="4"><span>Note</span><span style="text-transform: none">: Default for notification targeting</span></div><p class="">
          The follow activity generally is a request to see the objects an actor
          creates. This makes the Followers collection an appropriate default
          target for <a href="#delivery">delivery</a> of notifications.
        </p></div>
      </section>

      <section id="following">
        <h3 id="x5-4-following-collection"><span class="secno">5.4 </span>Following Collection</h3>
        <p>
          Every actor <em class="rfc2119" title="SHOULD">SHOULD</em> have a <code>following</code> collection.
          This is a list of everybody that the actor has followed, added as a
          <a href="#follow-activity-outbox">side effect</a>.
          The <code>following</code> collection <em class="rfc2119" title="MUST">MUST</em> be either an
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-orderedcollection">
            <code>OrderedCollection</code></a>
          or a
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-collection">
            <code>Collection</code></a>
          and <em class="rfc2119" title="MAY">MAY</em> be filtered on privileges of an authenticated user
          or as appropriate when no authentication is given.
        </p>
      </section>

      <section id="liked">
        <h3 id="x5-5-liked-collection"><span class="secno">5.5 </span>Liked Collection</h3>
        <p>
          Every actor <em class="rfc2119" title="MAY">MAY</em> have a <code>liked</code> collection.
          This is a list of every object from all of the actor's <code>Like</code>
          activities, added as a <a href="#like-activity-outbox">side effect</a>.
          The <code>liked</code> collection <em class="rfc2119" title="MUST">MUST</em> be either an
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-orderedcollection">
            <code>OrderedCollection</code></a>
          or a
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-collection">
            <code>Collection</code></a>
          and <em class="rfc2119" title="MAY">MAY</em> be filtered on privileges of an authenticated user
          or as appropriate when no authentication is given.
        </p>
      </section>

      <section id="public-addressing">
        <h3 id="x5-6-public-addressing"><span class="secno">5.6 </span>Public Addressing</h3>
        <p>
          In addition to [<cite><a class="bibref" href="#bib-ActivityStreams">ActivityStreams</a></cite>] collections and objects,
          Activities may additionally be addressed to the special "public"
          collection, with the identifier
          <code>https://www.w3.org/ns/activitystreams#Public</code>.
          For example:
        </p>
        <div class="example"><div class="example-title marker"><span>Example 10</span></div><pre class="hljs json" aria-busy="false" aria-live="polite">{
  <span class="hljs-attr">"@context"</span>: <span class="hljs-string">"https://www.w3.org/ns/activitystreams"</span>,
  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"https://www.w3.org/ns/activitystreams#Public"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Collection"</span>
}</pre></div>
        <p>
          Activities addressed to this special URI shall be accessible to all
          users, without authentication.
          Implementations <em class="rfc2119" title="MUST NOT">MUST NOT</em> deliver to the "public" special collection;
          it is not capable of receiving actual activities.
          However, actors <em class="rfc2119" title="MAY">MAY</em> have a
          <a href="#sharedInbox"><code>sharedInbox</code></a>
          endpoint which is available for efficient shared delivery of public
          posts (as well as posts to followers-only); see
          <a href="#shared-inbox-delivery" class="sec-ref"><span class="secno">7.1.3</span> <span class="sec-title">Shared Inbox Delivery</span></a>.
        </p>
        <div class="note"><div role="heading" class="note-title marker" id="h-note-5" aria-level="4"><span>Note</span></div><div class="">
          <p>
            Compacting an ActivityStreams object using the ActivityStreams
            JSON-LD context might result in
            <code>https://www.w3.org/ns/activitystreams#Public</code>
            being represented as simply <code>Public</code> or <code>as:Public</code>
            which are valid representations of the Public collection.
            Implementations which treat ActivityStreams objects as simply
            JSON rather than converting an incoming activity over to a
            local context using JSON-LD tooling should be aware of this
            and should be prepared to accept all three representations.
          </p>
        </div></div>
      </section>

      <section id="likes">
        <h3 id="x5-7-likes-collection"><span class="secno">5.7 </span>Likes Collection</h3>
        <p>
          Every object <em class="rfc2119" title="MAY">MAY</em> have a <code>likes</code> collection.
          This is a list of all <code>Like</code> activities with this object
          as the <code>object</code> property, added as a
          <a href="#like-activity-inbox">side effect</a>.
          The <code>likes</code> collection <em class="rfc2119" title="MUST">MUST</em> be either an
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-orderedcollection">
            <code>OrderedCollection</code></a>
          or a
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-collection">
            <code>Collection</code></a>
          and <em class="rfc2119" title="MAY">MAY</em> be filtered on privileges of an authenticated user
          or as appropriate when no authentication is given.
        </p>

        <div class="note"><div role="heading" class="note-title marker" id="h-note-6" aria-level="4"><span>Note</span></div><div class="">
          <p>
            Care should be taken to not confuse the the
            <a href="#likes"><code>likes</code></a>
            collection with the similarly named but different
            <a href="#liked"><code>liked</code></a> collection.
            In sum:
          </p>

          <ul>
            <li>
              <b>liked:</b>
              Specifically a property of actors.
              This is a collection of <code>Like</code> activities performed
              <i>by the actor</i>,
              added to the collection as a
              <a href="#like-activity-outbox">
                side effect of delivery to the outbox</a>.
            </li>

            <li>
              <b>likes:</b>
              May be a property of any object.
              This is a collection of <code>Like</code> activities referencing
              this object,
              added to the collection as a
              <a href="#like-activity-inbox">
                side effect of delivery to the inbox</a>.
            </li>
          </ul>
        </div></div>
      </section>

      <section id="shares">
        <h3 id="x5-8-shares-collection"><span class="secno">5.8 </span>Shares Collection</h3>
        <p>
          Every object <em class="rfc2119" title="MAY">MAY</em> have a <code>shares</code> collection.
          This is a list of all <code>Announce</code> activities with this object
          as the <code>object</code> property, added as a
          <a href="#announce-activity-inbox">side effect</a>.
          The <code>shares</code> collection <em class="rfc2119" title="MUST">MUST</em> be either an
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-orderedcollection">
            <code>OrderedCollection</code></a>
          or a
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-collection">
            <code>Collection</code></a>
          and <em class="rfc2119" title="MAY">MAY</em> be filtered on privileges of an authenticated user
          or as appropriate when no authentication is given.
        </p>
      </section>
    </section>

    <section id="client-to-server-interactions">
      <!--OddPage--><h2 id="x6-client-to-server-interactions"><span class="secno">6. </span>Client to Server Interactions</h2>
      <p>
        Activities as defined by [<cite><a class="bibref" href="#bib-ActivityStreams">ActivityStreams</a></cite>] are the core mechanism
        for creating, modifying and sharing content within the social graph.
      </p>

      <p>
        Client to server interaction takes place through clients posting
        Activities to an actor's <a href="#outbox">outbox</a>.
        To do this, clients <em class="rfc2119" title="MUST">MUST</em> discover the URL of the actor's outbox from
	their <a href="#actor-objects">profile</a> and then <em class="rfc2119" title="MUST">MUST</em> make an HTTP
        <code>POST</code> request to this URL with the Content-Type of
        <code>application/ld+json; profile="https://www.w3.org/ns/activitystreams"</code>.
        Servers <em class="rfc2119" title="MAY">MAY</em> interpret a Content-Type or Accept header of
        <code>application/activity+json</code> as equivalent
        to <code>application/ld+json; profile="https://www.w3.org/ns/activitystreams"</code>
        for client-to-server interactions.
        The request <em class="rfc2119" title="MUST">MUST</em> be authenticated with the credentials of the user to
        whom the outbox belongs.
        The body of the <code>POST</code> request <em class="rfc2119" title="MUST">MUST</em> contain a single
        Activity (which <em class="rfc2119" title="MAY">MAY</em> contain embedded objects), or a single non-Activity
        object which
        <a href="#object-without-create">will be wrapped in a Create activity
          by the server</a>.
      </p>
      <div class="example"><div class="example-title marker"><span>Example 11</span><span style="text-transform: none">: Submitting an Activity to the Outbox</span></div><pre class="hljs http" aria-busy="false" aria-live="polite"><span class="hljs-keyword">POST</span> <span class="hljs-string">/outbox/</span> HTTP/1.1
<span class="hljs-attribute">Host</span>: dustycloud.org
<span class="hljs-attribute">Authorization</span>: Bearer XXXXXXXXXXX
<span class="hljs-attribute">Content-Type</span>: application/ld+json; profile="https://www.w3.org/ns/activitystreams"

<span class="json">{
  <span class="hljs-attr">"@context"</span>: [<span class="hljs-string">"https://www.w3.org/ns/activitystreams"</span>,
               {<span class="hljs-attr">"@language"</span>: <span class="hljs-string">"en"</span>}],
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Like"</span>,
  <span class="hljs-attr">"actor"</span>: <span class="hljs-string">"https://dustycloud.org/chris/"</span>,
  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Chris liked 'Minimal ActivityPub update client'"</span>,
  <span class="hljs-attr">"object"</span>: <span class="hljs-string">"https://rhiaro.co.uk/2016/05/minimal-activitypub"</span>,
  <span class="hljs-attr">"to"</span>: [<span class="hljs-string">"https://rhiaro.co.uk/#amy"</span>,
         <span class="hljs-string">"https://dustycloud.org/followers"</span>,
         <span class="hljs-string">"https://rhiaro.co.uk/followers/"</span>],
  <span class="hljs-attr">"cc"</span>: <span class="hljs-string">"https://e14n.com/evan"</span>
}</span></pre></div>

      <p>
        If an Activity is submitted with a value in the <code>id</code>
        property, servers <em class="rfc2119" title="MUST">MUST</em> ignore this and generate a new <code>id</code>
        for the Activity.
        Servers <em class="rfc2119" title="MUST">MUST</em> return a <code>201 Created</code> HTTP code, and unless
        the activity is transient, <em class="rfc2119" title="MUST">MUST</em> include the new <code>id</code> in the
        <code>Location</code> header.
      </p>
      <div class="example"><div class="example-title marker"><span>Example 12</span><span style="text-transform: none">: Outbox response to submitted Activity</span></div><pre class="hljs http" aria-busy="false" aria-live="polite">HTTP/1.1 <span class="hljs-number">201</span> Created
<span class="hljs-attribute">Location</span>: https://dustycloud.org/likes/345</pre></div>

      <p id="remove-bto-bcc-before-delivery">
        The server <em class="rfc2119" title="MUST">MUST</em> remove the <code>bto</code> and/or <code>bcc</code>
        properties, if they exist, from the ActivityStreams object before
        delivery, but <em class="rfc2119" title="MUST">MUST</em> utilize the addressing originally stored
        on the <code>bto</code> / <code>bcc</code> properties for determining
        recipients in <a href="#delivery">delivery</a>.
      </p>

      <p>
        The server <em class="rfc2119" title="MUST">MUST</em> then add this new Activity to the
        <a href="#outbox">outbox</a> collection.
        Depending on the type of Activity, servers may then be required to
        carry out further side effects.
        (However, there is no guarantee that time the Activity may appear in
        the outbox.
        The Activity might appear after a delay or disappear at any period).
        These are described per individual Activity below.
      </p>

      <p>
        Attempts to submit objects to servers not implementing client to server
        support <em class="rfc2119" title="SHOULD">SHOULD</em> result in a <code>405 Method Not Allowed</code> response.
      </p>


      <p>
        HTTP caching mechanisms [<cite><a class="bibref" href="#bib-RFC7234">RFC7234</a></cite>] <em class="rfc2119" title="SHOULD">SHOULD</em> be respected when
        appropriate, both in clients receiving responses from servers as well
        as servers sending responses to clients.
      </p>

      <section id="client-addressing">
        <h3 id="x6-1-client-addressing"><span class="secno">6.1 </span>Client Addressing</h3>
          <p>
          <strong>Clients</strong> are responsible for addressing new Activities
          appropriately.
          To some extent, this is dependent upon the particular client
          implementation, but clients must be aware that the server will only
          forward new Activities to addressees in the <code>to</code>,
          <code>bto</code>, <code>cc</code>, <code>bcc</code>, and
          <code>audience</code> fields.
        </p>
        <p>
          The <a href="#followers">Followers Collection</a> and/or the
          <a href="#public-addressing">Public Collection</a> are good
          choices for the default addressing of new Activities.
        </p>
        <p>
          Clients <em class="rfc2119" title="SHOULD">SHOULD</em> look at any objects attached to the new Activity via the
          <code>object</code>, <code>target</code>, <code>inReplyTo</code> and/or
          <code>tag</code> fields, retrieve <em>their</em> <code>actor</code> or
          <code>attributedTo</code> properties, and <em class="rfc2119" title="MAY">MAY</em> also retrieve their addressing
          properties, and add these to the <code>to</code> or <code>cc</code>
          fields of the new Activity being created.
          Clients <em class="rfc2119" title="MAY">MAY</em> recurse through attached objects, but if doing so, <em class="rfc2119" title="SHOULD">SHOULD</em>
          set a limit for this recursion.
          (Note that this does not suggest that the client should "unpack"
          collections of actors being addressed as individual recipients).
        </p>
        <p>
          Clients <em class="rfc2119" title="MAY">MAY</em> give the user the chance to amend this addressing in the
          UI.
        </p>
        <p>
          For example, when Chris likes the following article by Amy:
        </p>

        <div class="example"><div class="example-title marker"><span>Example 13</span><span style="text-transform: none">: An Article</span></div><pre class="hljs json" aria-busy="false" aria-live="polite">{
  <span class="hljs-attr">"@context"</span>: [<span class="hljs-string">"https://www.w3.org/ns/activitystreams"</span>,
               {<span class="hljs-attr">"@language"</span>: <span class="hljs-string">"en-GB"</span>}],
  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"https://rhiaro.co.uk/2016/05/minimal-activitypub"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Article"</span>,
  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Minimal ActivityPub update client"</span>,
  <span class="hljs-attr">"content"</span>: <span class="hljs-string">"Today I finished morph, a client for posting ActivityStreams2..."</span>,
  <span class="hljs-attr">"attributedTo"</span>: <span class="hljs-string">"https://rhiaro.co.uk/#amy"</span>,
  <span class="hljs-attr">"to"</span>: <span class="hljs-string">"https://rhiaro.co.uk/followers/"</span>,
  <span class="hljs-attr">"cc"</span>: <span class="hljs-string">"https://e14n.com/evan"</span>
}</pre></div>

        <p>the like is generated by the client as:</p>

        <div class="example"><div class="example-title marker"><span>Example 14</span><span style="text-transform: none">: A Like of the Article</span></div><pre class="hljs json" aria-busy="false" aria-live="polite">{
  <span class="hljs-attr">"@context"</span>: [<span class="hljs-string">"https://www.w3.org/ns/activitystreams"</span>,
               {<span class="hljs-attr">"@language"</span>: <span class="hljs-string">"en"</span>}],
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Like"</span>,
  <span class="hljs-attr">"actor"</span>: <span class="hljs-string">"https://dustycloud.org/chris/"</span>,
  <span class="hljs-attr">"summary"</span>: <span class="hljs-string">"Chris liked 'Minimal ActivityPub update client'"</span>,
  <span class="hljs-attr">"object"</span>: <span class="hljs-string">"https://rhiaro.co.uk/2016/05/minimal-activitypub"</span>,
  <span class="hljs-attr">"to"</span>: [<span class="hljs-string">"https://rhiaro.co.uk/#amy"</span>,
         <span class="hljs-string">"https://dustycloud.org/followers"</span>,
         <span class="hljs-string">"https://rhiaro.co.uk/followers/"</span>],
  <span class="hljs-attr">"cc"</span>: <span class="hljs-string">"https://e14n.com/evan"</span>
}</pre></div>

        <p>The receiving outbox can then perform <a href="#delivery">delivery</a>
        to not only the followers of Chris (the liker), but also to Amy, and Amy's
        followers and Evan, both of whom received the original article.</p>

        <p>
          Clients submitting the following activities to an <code>outbox</code>
          <em class="rfc2119" title="MUST">MUST</em> provide the <code>object</code> property in the activity:
          <code>Create</code>, <code>Update</code>, <code>Delete</code>,
          <code>Follow</code>, <code>Add</code>, <code>Remove</code>,
          <code>Like</code>, <code>Block</code>, <code>Undo</code>.
          Additionally, clients submitting the following activities to an outbox
          <em class="rfc2119" title="MUST">MUST</em> also provide the <code>target</code> property:
          <code>Add</code>, <code>Remove</code>.
        </p>

      </section>


      <section id="create-activity-outbox">
        <h3 id="x6-2-create-activity"><span class="secno">6.2 </span>Create Activity</h3>
        <p>
          The <code>Create</code> activity is used when posting a new object.
          This has the side effect that the object embedded within the Activity
          (in the <code>object</code> property) is created.
        </p>
        <p>
          When a <code>Create</code> activity is posted, the <code>actor</code>
          of the activity <em class="rfc2119" title="SHOULD">SHOULD</em> be copied onto the <code>object</code>'s
          <code>attributedTo</code> field.
        </p>
        <p>
          A mismatch between addressing of the Create activity and its
          <code>object</code> is likely to lead to confusion.
          As such, a server <em class="rfc2119" title="SHOULD">SHOULD</em> copy any recipients of the Create activity
          to its <code>object</code> upon initial distribution, and likewise
          with copying recipients from the <code>object</code> to the wrapping
          Create activity.
          Note that it is acceptable for the <code>object</code>'s addressing
          to be changed later without changing the <code>Create</code>'s
          addressing (for example via an <code>Update</code> activity).
        </p>

        <section id="object-without-create">
        <h4 id="x6-2-1-object-creation-without-a-create-activity"><span class="secno">6.2.1 </span>Object creation without a Create Activity</h4>
        <p>
          For client to server posting, it is possible to submit an object for
          creation without a surrounding activity.
          The server <em class="rfc2119" title="MUST">MUST</em> accept a valid [<cite><a class="bibref" href="#bib-ActivityStreams">ActivityStreams</a></cite>] object that
          isn't a subtype of <code>Activity</code> in the POST request to the
          outbox.
          The server then <em class="rfc2119" title="MUST">MUST</em> attach this object as the <code>object</code>
          of a <a href="#create-activity-outbox">Create Activity</a>.
          For non-transient objects, the server <em class="rfc2119" title="MUST">MUST</em> attach an
          <code>id</code> to both the wrapping <code>Create</code> and its
          wrapped <code>Object</code>.
        </p>

        <div class="note"><div role="heading" class="note-title marker" id="h-note-7" aria-level="5"><span>Note</span></div><p class="">
          The <code>Location</code> value returned by the server should be the URL of
          the new Create activity (rather than the object).
        </p></div>

        <p>
          Any <code>to</code>, <code>bto</code>, <code>cc</code>, <code>bcc</code>,
          and <code>audience</code> properties specified on the object <em class="rfc2119" title="MUST">MUST</em> be
          copied over to the new Create activity by the server.
        </p>

        <div class="example"><div class="example-title marker"><span>Example 15</span><span style="text-transform: none">: Object with audience targeting</span></div><pre class="hljs json" aria-busy="false" aria-live="polite">{
  <span class="hljs-attr">"@context"</span>: <span class="hljs-string">"https://www.w3.org/ns/activitystreams"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Note"</span>,
  <span class="hljs-attr">"content"</span>: <span class="hljs-string">"This is a note"</span>,
  <span class="hljs-attr">"published"</span>: <span class="hljs-string">"2015-02-10T15:04:55Z"</span>,
  <span class="hljs-attr">"to"</span>: [<span class="hljs-string">"https://example.org/~john/"</span>],
  <span class="hljs-attr">"cc"</span>: [<span class="hljs-string">"https://example.com/~erik/followers"</span>,
         <span class="hljs-string">"https://www.w3.org/ns/activitystreams#Public"</span>]
}</pre></div>

        The above example could be converted to this:
        <div class="example"><div class="example-title marker"><span>Example 16</span><span style="text-transform: none">: Create Activity wrapper generated by the server</span></div><pre class="hljs json" aria-busy="false" aria-live="polite">{
  <span class="hljs-attr">"@context"</span>: <span class="hljs-string">"https://www.w3.org/ns/activitystreams"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Create"</span>,
  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"https://example.net/~mallory/87374"</span>,
  <span class="hljs-attr">"actor"</span>: <span class="hljs-string">"https://example.net/~mallory"</span>,
  <span class="hljs-attr">"object"</span>: {
    <span class="hljs-attr">"id"</span>: <span class="hljs-string">"https://example.com/~mallory/note/72"</span>,
    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Note"</span>,
    <span class="hljs-attr">"attributedTo"</span>: <span class="hljs-string">"https://example.net/~mallory"</span>,
    <span class="hljs-attr">"content"</span>: <span class="hljs-string">"This is a note"</span>,
    <span class="hljs-attr">"published"</span>: <span class="hljs-string">"2015-02-10T15:04:55Z"</span>,
    <span class="hljs-attr">"to"</span>: [<span class="hljs-string">"https://example.org/~john/"</span>],
    <span class="hljs-attr">"cc"</span>: [<span class="hljs-string">"https://example.com/~erik/followers"</span>,
           <span class="hljs-string">"https://www.w3.org/ns/activitystreams#Public"</span>]
  },
  <span class="hljs-attr">"published"</span>: <span class="hljs-string">"2015-02-10T15:04:55Z"</span>,
  <span class="hljs-attr">"to"</span>: [<span class="hljs-string">"https://example.org/~john/"</span>],
  <span class="hljs-attr">"cc"</span>: [<span class="hljs-string">"https://example.com/~erik/followers"</span>,
         <span class="hljs-string">"https://www.w3.org/ns/activitystreams#Public"</span>]
}</pre></div>
        </section>
      </section>
      <section id="update-activity-outbox">
        <h3 id="x6-3-update-activity"><span class="secno">6.3 </span>Update Activity</h3>
        <p>
          The <code>Update</code> activity is used when updating an already
          existing object.
          The side effect of this is that the <code>object</code> <em class="rfc2119" title="MUST">MUST</em> be
          modified to reflect the new structure as defined in the update
          activity, assuming the actor has permission to update this
          object.
        </p>

        <section id="partial-updates">
          <h4 id="x6-3-1-partial-updates"><span class="secno">6.3.1 </span>Partial Updates</h4>
          <p>
            For client to server interactions, updates are partial;
            rather than updating the document all at once, any key value
            pair supplied is used to replace the existing value with
            the new value.
            This only applies to the top-level fields of the updated
            object.
            A special exception is for when the value is the json
            <code>null</code> type; this means that this field should be
            removed from the server's representation of the object.
          </p>
          <p>
            Note that this behavior is for client to server interaction where
            the client is posting to the server only.
            Server to server interaction and updates from the server to the client
            should contain the entire new representation of the object, after
            the partial update application has been applied.
            See the description of the
            <a href="#update-activity-inbox">Update activity for server to server
              interactions</a>
            for more details.
          </p>
        </section>
      </section>
      <section id="delete-activity-outbox">
        <h3 id="x6-4-delete-activity"><span class="secno">6.4 </span>Delete Activity</h3>
        <p>
          The <code>Delete</code> activity is used to delete an already
          existing object.
          The side effect of this is that the server <em class="rfc2119" title="MAY">MAY</em> replace the
          <code>object</code> with a <code>Tombstone</code> of the object
          that will be displayed in activities which reference the deleted
          object.
          If the deleted object is requested the server <em class="rfc2119" title="SHOULD">SHOULD</em> respond with
          either the HTTP 410 Gone status code if a <code>Tombstone</code>
          object is presented as the response body, otherwise respond with a
          HTTP 404 Not Found.
        </p>

        <p>A deleted object:</p>
        <div class="example"><div class="example-title marker"><span>Example 17</span></div><pre class="hljs json" aria-busy="false" aria-live="polite">{
  <span class="hljs-attr">"@context"</span>: <span class="hljs-string">"https://www.w3.org/ns/activitystreams"</span>,
  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"https://example.com/~alice/note/72"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Tombstone"</span>,
  <span class="hljs-attr">"published"</span>: <span class="hljs-string">"2015-02-10T15:04:55Z"</span>,
  <span class="hljs-attr">"updated"</span>: <span class="hljs-string">"2015-02-10T15:04:55Z"</span>,
  <span class="hljs-attr">"deleted"</span>: <span class="hljs-string">"2015-02-10T15:04:55Z"</span>
}</pre></div>
      </section>
      <section id="follow-activity-outbox">
        <h3 id="x6-5-follow-activity"><span class="secno">6.5 </span>Follow Activity</h3>
        <p>
          The <code>Follow</code> activity is used to subscribe to the
          activities of another actor.
        </p>
        <p>
          The side effect of receiving this in an <strong>outbox</strong>
          is that the server <em class="rfc2119" title="SHOULD">SHOULD</em> add the <code>object</code> to the
          <code>actor</code>'s <a href="#following"><code>following</code> Collection</a>
          when and only if an <code>Accept</code> activity is subsequently
          received with this <code>Follow</code> activity as its object.
        </p>
      </section>
      <section id="add-activity-outbox">
        <h3 id="x6-6-add-activity"><span class="secno">6.6 </span>Add Activity</h3>
        <p>
          Upon receipt of an <code>Add</code> activity into the
          <strong>outbox</strong>, the server <em class="rfc2119" title="SHOULD">SHOULD</em>
          add the <code>object</code> to the collection specified in the
          <code>target</code> property, unless:
        </p>
        <ul>
          <li>
            the <code>target</code> is not owned by the receiving
            server, and thus they are not authorized to update it.
          </li>
          <li>
            the <code>object</code> is not allowed to be added to the
            <code>target</code> collection for some other reason, at the
            receiving server's discretion.
          </li>
        </ul>
      </section>
      <section id="remove-activity-outbox">
        <h3 id="x6-7-remove-activity"><span class="secno">6.7 </span>Remove Activity</h3>
        <p>
          Upon receipt of a <code>Remove</code> activity into the
          <strong>outbox</strong>, the server <em class="rfc2119" title="SHOULD">SHOULD</em>
          remove the <code>object</code> from the collection specified in the
          <code>target</code> property, unless:
        </p><ul>
          <li>
            the <code>target</code> is not owned by the receiving server, and
            thus they are not authorized to update it.
          </li>
          <li>
            the <code>object</code> is not allowed to be removed from the
            <code>target</code> collection for some other reason, at the
            receiving server's discretion.
          </li>
        </ul>
      </section>
      <section id="like-activity-outbox">
        <h3 id="x6-8-like-activity"><span class="secno">6.8 </span>Like Activity</h3>
        <p>
          The <code>Like</code> activity indicates the <code>actor</code> likes
          the <code>object</code>.
        </p>
        <p>
          The side effect of receiving this in an <strong>outbox</strong>
          is that the server <em class="rfc2119" title="SHOULD">SHOULD</em> add the <code>object</code> to the
          <code>actor</code>'s <a href="#liked"><code>liked</code> Collection</a>.
        </p>
      </section>
      <section id="block-activity-outbox">
        <h3 id="x6-9-block-activity"><span class="secno">6.9 </span>Block Activity</h3>
        <p>
          The <code>Block</code> activity is used to indicate that the posting
          actor does not want another actor (defined in the <code>object</code>
          property) to be able to interact with objects posted by the actor
          posting the <code>Block</code> activity.
          The server <em class="rfc2119" title="SHOULD">SHOULD</em> prevent the blocked user from interacting with any object
          posted by the actor.
        </p>
        <p>
          Servers <em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em> deliver Block Activities to their <code>object</code>.
        </p>
      </section>
      <section id="undo-activity-outbox">
        <h3 id="x6-10-undo-activity"><span class="secno">6.10 </span>Undo Activity</h3>
        <p>
          The <code>Undo</code> activity is used to undo a previous activity.
          See the Activity Vocabulary documentation on
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#inverse">
            Inverse Activities and "Undo"</a>.
          For example, <code>Undo</code> may be used to undo a previous
          <code>Like</code>, <code>Follow</code>, or <code>Block</code>.
          The undo activity and the activity being undone <em class="rfc2119" title="MUST">MUST</em> both have the
          same actor.
          Side effects should be undone, to the extent possible.
          For example, if undoing a <code>Like</code>, any counter that had
          been incremented previously should be decremented appropriately.
        </p>

        <p>
          There are some exceptions where there is an existing and explicit
          "inverse activity" which should be used instead.
          <code>Create</code> based activities should instead use
          <code>Delete</code>, and <code>Add</code> activities should use
          <code>Remove</code>.
        </p>
      </section>

      <section id="client-to-server-outbox-delivery">
        <h3 id="x6-11-delivery"><span class="secno">6.11 </span>Delivery</h3>
        <p>
          Federated servers <em class="rfc2119" title="MUST">MUST</em> perform delivery on all Activities posted to the
          <strong>outbox</strong> according to <a href="#outbox-delivery">
          outbox delivery</a>.
        </p>
      </section>

      <section id="uploading-media" class="informative">
        <h3 id="x6-12-uploading-media"><span class="secno">6.12 </span>Uploading Media</h3><p><em>This section is non-normative.</em></p>
        <p>
          Servers <em class="rfc2119" title="MAY">MAY</em> support uploading document types to be referenced in
          activites, such as images, video or other binary data, but the
          precise mechanism is out of scope for this version of ActivityPub.
          The Social Web Community Group is refining the protocol in the
          <a href="https://www.w3.org/wiki/SocialCG/ActivityPub/MediaUpload">ActivityPub Media Upload report</a>.
        </p>
      </section>


    </section>

    <section id="server-to-server-interactions">
      <!--OddPage--><h2 id="x7-server-to-server-interactions"><span class="secno">7. </span>Server to Server Interactions</h2>
      <p>
        Servers communicate with other servers and propagate information across
        the social graph by posting activities to actors'
        <a href="#inbox">inbox</a> endpoints.
        An Activity sent over the network <em class="rfc2119" title="SHOULD">SHOULD</em> have an <code>id</code>,
        unless it is intended to be transient (in which case it <em class="rfc2119" title="MAY">MAY</em> omit the
        <code>id</code>).
      </p><p>
        <code>POST</code> requests (eg. to the inbox) <em class="rfc2119" title="MUST">MUST</em> be made with a Content-Type of
        <code>application/ld+json; profile="https://www.w3.org/ns/activitystreams"</code>
        and <code>GET</code> requests (see also <a href="#retrieving-objects" class="sec-ref"><span class="secno">3.2</span> <span class="sec-title">Retrieving objects</span></a>) 
        with an Accept header of 
        <code>application/ld+json; profile="https://www.w3.org/ns/activitystreams"</code>.
        Servers <em class="rfc2119" title="SHOULD">SHOULD</em> interpret a Content-Type or Accept
        header of <code>application/activity+json</code> as equivalent
        to <code>application/ld+json; profile="https://www.w3.org/ns/activitystreams"</code>
        for server-to-server interactions.
      </p>
      <p>
        In order to propagate updates throughout the social graph, Activities
        are sent to the appropriate recipients.
        First, these recipients are determined through following the
        appropriate links between objects until you reach an actor, and then
        the Activity is inserted into the actor's <em>inbox</em>
        (<a href="#delivery">delivery</a>).
        This allows recipient servers to:
      </p>
      <ul>
        <li>
          conduct any side effects related to the Activity (for example,
          notification that an actor has liked an object is used to update the
          object's like count);
        </li>
        <li>
          deliver the Activity to recipients of the original object, to ensure
          updates are propagated to the whole social graph (see <a href="#inbox-forwarding">
          inbox delivery</a>).
        </li>
      </ul>
      <p>Delivery is usually triggered by, for example:</p>
      <ul>
        <li>
          an Activity being created in an actor's <a href="#outbox">outbox</a>
          with their <a href="#followers">Followers Collection</a> as the
          recipient.
        </li>
        <li>
          an Activity being created in an actor's <a href="#outbox">outbox</a>
          with directly addressed recipients.
        </li>
        <li>
          an Activity being created in an actors's <a href="#outbox">outbox</a>
          with user-curated collections as recipients.
        </li>
        <li>
          an Activity being created in an actor's <a href="#outbox">outbox</a> or
          <a href="#inbox">inbox</a> which references another object.
        </li>
      </ul>

      <p>
        Servers performing delivery to the <code>inbox</code> or
        <code>sharedInbox</code> properties of actors on other servers <em class="rfc2119" title="MUST">MUST</em>
        provide the <code>object</code> property in the activity:
        <code>Create</code>, <code>Update</code>, <code>Delete</code>,
        <code>Follow</code>, <code>Add</code>, <code>Remove</code>,
        <code>Like</code>, <code>Block</code>, <code>Undo</code>.
        Additionally, servers performing server to server delivery of the
        following activities <em class="rfc2119" title="MUST">MUST</em> also provide the <code>target</code>
        property: <code>Add</code>, <code>Remove</code>.
      </p>

      <p>
        HTTP caching mechanisms [<cite><a class="bibref" href="#bib-RFC7234">RFC7234</a></cite>] <em class="rfc2119" title="SHOULD">SHOULD</em> be respected when
        appropriate, both when receiving responses from other servers as well
        as sending responses to other servers.
      </p>

      <section id="delivery">
        <h3 id="x7-1-delivery"><span class="secno">7.1 </span>Delivery</h3>

        <p><i>
          The following is required by federated servers communicating with
          other federated servers only.
        </i></p>

        <p>
          An activity is delivered to its targets (which are
          <a href="#actors">actors</a>) by first looking up the targets'
          inboxes and then posting the activity to those inboxes.
          Targets for delivery are determined by checking the
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#audienceTargeting">
            ActivityStreams audience targeting</a>;
          namely, the <code>to</code>, <code>bto</code>, <code>cc</code>,
          <code>bcc</code>, and <code>audience</code> fields of the activity.
        </p>

        <p>
          The <a href="#inbox">inbox</a> is determined by first
          <a href="#retrieving-objects">
            retrieving the target actor's JSON-LD representation</a>
          and then looking up the <code>inbox</code> property.
          If a recipient is a <code>Collection</code> or <code>OrderedCollection</code>,
          then the server <em class="rfc2119" title="MUST">MUST</em> dereference the collection (with the user's
          credentials) and discover inboxes for each item in the collection.
          Servers <em class="rfc2119" title="MUST">MUST</em> limit the number of layers of indirections through
          collections which will be performed, which <em class="rfc2119" title="MAY">MAY</em> be one.
        </p>

        <p>
          Servers <em class="rfc2119" title="MUST">MUST</em> de-duplicate the final recipient list. Servers <em class="rfc2119" title="MUST">MUST</em> also
          exclude actors from the list which are the same as the <code>actor</code>
          of the Activity being notified about. That is, actors shouldn't have their
          own activities delivered to themselves.
        </p>

        <div class="note"><div role="heading" class="note-title marker" id="h-note-8" aria-level="4"><span>Note</span><span style="text-transform: none">: Silent and private activities</span></div><p class="">
          What to do when there are no recipients specified is not defined,
          however it's recommended that if no recipients are specified the
          object remains completely private and access controls restrict the
          access to object.
          If the object is just sent to the "public" collection the object is
          not delivered to any actors but is publicly viewable in the actor's
          outbox.
        </p></div>

        <p>
          An HTTP POST request (with authorization of the submitting user) is
          then made to the <a href="#inbox">inbox</a>, with the Activity as
          the body of the request.
          This Activity is added by the receiver as an <code>item</code> in the
          <a href="#inbox">inbox</a> OrderedCollection.
          Attempts to deliver to an inbox on a non-federated server <em class="rfc2119" title="SHOULD">SHOULD</em>
          result in a <code>405 Method Not Allowed</code> response.
        </p>

        <p>
          For federated servers performing delivery to a third party server,
          delivery <em class="rfc2119" title="SHOULD">SHOULD</em> be performed asynchronously, and <em class="rfc2119" title="SHOULD">SHOULD</em> additionally
          retry delivery to recipients if it fails due to network error.
        </p>

        <p>
          <strong>Note:</strong> Activities being distributed between actors on
          the same origin may use any internal mechanism, and are not required
          to use HTTP.
        </p>

        <div class="note"><div role="heading" class="note-title marker" id="h-note-9" aria-level="4"><span>Note</span><span style="text-transform: none">: Relationship to Linked Data Notifications</span></div><p class="" id="ldn-relationship">
          While it is not required reading to understand this specification,
          it is worth noting that ActivityPub's targeting and delivery
          mechanism overlaps with the
          <a href="https://www.w3.org/TR/ldn/">Linked Data Notifications</a>
          specification, and the two specifications may interoperably
          combined.
          In particular, the <code>inbox</code> property is the same between
          ActivityPub and Linked Data Notifications, and the targeting
          and delivery systems described in this document are supported
          by Linked Data Notifications.
          In addition to JSON-LD compacted ActivityStreams documents, Linked
          Data Notifications also supports a number of RDF serializations
          which are not required for ActivityPub implementations.
          However, ActivityPub implementations which wish to be more broadly
          compatible with Linked Data Notifications implementations may wish to
          support other RDF representations.
        </p></div>

        <section id="outbox-delivery">
          <h4 id="x7-1-1-outbox-delivery-requirements-for-server-to-server"><span class="secno">7.1.1 </span>Outbox Delivery Requirements for Server to Server</h4>
          <p>
            When objects are received in the <a href="#outbox">outbox</a>
            (for servers which support both
            <a href="#client-to-server-interactions">Client to Server interactions</a>
            and
            <a href="#server-to-server-interactions">Server to Server Interactions</a>),
            the server <em class="rfc2119" title="MUST">MUST</em> target and deliver to:
          </p>
          <ul>
            <li>
              The <code>to</code>, <code>bto</code>, <code>cc</code>,
              <code>bcc</code> or <code>audience</code> fields if their values
              are individuals or Collections owned by the actor.
            </li>
          </ul>
          <p>
            These fields will have been <a href="#client-addressing">
            populated appropriately by the client</a> which posted the Activity
            to the outbox.
          </p>
        </section>

        <section id="inbox-forwarding">
          <h4 id="x7-1-2-forwarding-from-inbox"><span class="secno">7.1.2 </span>Forwarding from Inbox</h4>

          <div class="note"><div role="heading" class="note-title marker" id="h-note-10" aria-level="5"><span>Note</span><span style="text-transform: none">: Forwarding to avoid the ghost replies problem</span></div><div class="">
            <p>
              The following section is to mitigate the "ghost replies" problem
              which occasionally causes problems on federated networks.
              This problem is best demonstrated with an example.
            </p>

            <p>
              Alyssa makes a post about her having successfully presented a
              paper at a conference and sends it to her followers collection,
              which includes her friend Ben.
              Ben replies to Alyssa's message congratulating her and includes
              her followers collection on the recipients.
              However, Ben has no access to see the members of Alyssa's
              followers collection, so his server does not forward his messages
              to their inbox.
              Without the following mechanism, if Alyssa were then to reply to
              Ben, her followers would see Alyssa replying to Ben without having
              ever seen Ben interacting.
              This would be very confusing!
            </p>
          </div></div>

          <p>
            When Activities are received in the <a href="#inbox">inbox</a>, the
            server needs to forward these to recipients that the origin was unable
            to deliver them to. To do this, the server <em class="rfc2119" title="MUST">MUST</em> target and
            <a href="#delivery">deliver</a>
            to the values of <code>to</code>, <code>cc</code>, and/or <code>audience</code>
            if and only if all of the following are true:
          </p>
          <ul>
            <li>This is the first time the server has seen this Activity.</li>
            <li>
              The values of <code>to</code>, <code>cc</code>, and/or
              <code>audience</code> contain a Collection owned by the server.
            </li>
            <li>
              The values of <code>inReplyTo</code>, <code>object</code>,
              <code>target</code> and/or <code>tag</code> are objects owned by
              the server.
              The server <em class="rfc2119" title="SHOULD">SHOULD</em> recurse through these values to look for linked objects
              owned by the server, and <em class="rfc2119" title="SHOULD">SHOULD</em> set a maximum limit for recursion (ie. the
              point at which the thread is so deep the recipients followers may not mind
              if they are no longer getting updates that don't directly involve the
              recipient).
              The server <em class="rfc2119" title="MUST">MUST</em> only target the values of <code>to</code>,
              <code>cc</code>, and/or <code>audience</code>
              on the original object being forwarded, and not pick up any new
              addressees whilst recursing through the linked objects
              (in case these addressees were purposefully amended by or via the client).
            </li>
          </ul>
          <p>
            The server <em class="rfc2119" title="MAY">MAY</em> filter its delivery targets according to
            implementation-specific rules (for example, spam filtering).
          </p>
        </section>

        <section id="shared-inbox-delivery">
          <h4 id="x7-1-3-shared-inbox-delivery"><span class="secno">7.1.3 </span>Shared Inbox Delivery</h4>
          <p>
            For servers hosting many actors, delivery to all followers can
            result in an overwhelming number of messages sent.
            Some servers would also like to display a list of all messages
            posted publicly to the "known network".
            Thus ActivityPub provides an optional mechanism for serving these
            two use cases.
          </p>
          <p>
            When an object is being delivered to the originating actor's
            followers, a server <em class="rfc2119" title="MAY">MAY</em> reduce the number of receiving actors
            delivered to by identifying all followers which share the same
            <a href="#sharedInbox">sharedInbox</a>
            who would otherwise be individual recipients and instead deliver
            objects to said <code>sharedInbox</code>.
            Thus in this scenario, the remote/receiving server participates
            in determining targeting and performing delivery to specific
            inboxes.
          </p>
          <p>
            Additionally, if an object is addressed to the
            <a href="#public-addressing">Public</a> special collection, a
            server <em class="rfc2119" title="MAY">MAY</em> deliver that object to all known
            <code>sharedInbox</code> endpoints on the network.
          </p>
          <p>
            Origin servers sending publicly addressed activities to
            <code>sharedInbox</code> endpoints <em class="rfc2119" title="MUST">MUST</em> still deliver to actors
            and collections otherwise addressed (through <code>to</code>,
            <code>bto</code>, <code>cc</code>, <code>bcc</code>, and
            <code>audience</code>) which do not have a <code>sharedInbox</code>
            and would not otherwise receive the activity through the
            <code>sharedInbox</code> mechanism.
          </p>
        </section>
      </section>

      <section id="create-activity-inbox">
        <h3 id="x7-2-create-activity"><span class="secno">7.2 </span>Create Activity</h3>
        <p>
          Receiving a <code>Create</code> activity in an <code>inbox</code> has
          surprisingly few side effects; the activity should appear in the
          actor's <code>inbox</code> and it is likely that the server will want
          to locally store a representation of this activity and its accompanying
          object.
          However, this mostly happens in general with processing activities
          delivered to an <code>inbox</code> anyway.
        </p>
      </section>

      <section id="update-activity-inbox">
        <h3 id="x7-3-update-activity"><span class="secno">7.3 </span>Update Activity</h3>
        <p>
          For server to server interactions, an <code>Update</code> activity
          means that the receiving server <em class="rfc2119" title="SHOULD">SHOULD</em> update its copy of the
          <code>object</code> of the same <code>id</code> to the copy
          supplied in the <code>Update</code> activity.
          Unlike the
          <a href="#update-activity-outbox">
            client to server handling of the Update activity</a>,
          this is not a partial update but a complete replacement of the object.
        </p>
        <p>
          The receiving server <em class="rfc2119" title="MUST">MUST</em> take care to be sure that the
          <code>Update</code> is authorized to modify its <code>object</code>.
          At minimum, this may be done by ensuring that the <code>Update</code>
          and its <code>object</code> are of same origin.
        </p>
      </section>

      <section id="delete-activity-inbox">
        <h3 id="x7-4-delete-activity"><span class="secno">7.4 </span>Delete Activity</h3>
        <p>
          The side effect of receiving this is that (assuming the
          <code>object</code> is owned by the sending actor / server) the
          server receiving the delete activity <em class="rfc2119" title="SHOULD">SHOULD</em> remove its representation
          of the <code>object</code> with the same <code>id</code>, and <em class="rfc2119" title="MAY">MAY</em>
          replace that representation with a <code>Tombstone</code> object.
        </p>
        <p>
          (Note that after an activity has been transmitted from an origin
          server to a remote server, there is nothing in the ActivityPub
          protocol that can <em>enforce</em> remote deletion of an object's
          representation).
        </p>
      </section>

      <section id="follow-activity-inbox">
        <h3 id="x7-5-follow-activity"><span class="secno">7.5 </span>Follow Activity</h3>

        <p>
          The side effect of receiving this in an <strong>inbox</strong> is
          that the server <em class="rfc2119" title="SHOULD">SHOULD</em> generate either an <code>Accept</code> or
          <code>Reject</code> activity with the Follow as the
          <code>object</code> and deliver it to the <code>actor</code> of the
          Follow.
          The <code>Accept</code> or <code>Reject</code> <em class="rfc2119" title="MAY">MAY</em> be generated
          automatically, or <em class="rfc2119" title="MAY">MAY</em> be the result of user input (possibly after
          some delay in which the user reviews).
          Servers <em class="rfc2119" title="MAY">MAY</em> choose to not explicitly send a <code>Reject</code>
          in response to a <code>Follow</code>, though implementors ought to
          be aware that the server sending the request could be left in an
          intermediate state.
          For example, a server might not send a <code>Reject</code> to protect
          a user's privacy.
        </p>

        <p>
          In the case of receiving an <code>Accept</code> referencing this
          <code>Follow</code> as the object, the server <em class="rfc2119" title="SHOULD">SHOULD</em> add the
          <code>actor</code> to the object actor's
          <a href="#followers">Followers Collection</a>.
          In the case of a <code>Reject</code>, the server <em class="rfc2119" title="MUST NOT">MUST NOT</em> add the
          actor to the object actor's
          <a href="#followers">Followers Collection</a>.
        </p>

        <div class="note"><div role="heading" class="note-title marker" id="h-note-11" aria-level="4"><span>Note</span></div><div class="">
          <p>
            Sometimes a successful <code>Follow</code> subscription may
            occur but at some future point delivery to the follower fails
            for an extended period of time.
            Implementations should be aware that there is no guarantee
            that actors on the network will remain reachable and should
            implement accordingly.
            For instance, if attempting to deliver to an actor for perhaps
            six months while the follower remains unreachable, it is
            reasonable that the delivering server remove the subscriber
            from the <code>followers</code> list.
            Timeframes and behavior for dealing with unreachable actors are
            left to the discretion of the delivering server.
          </p>
        </div></div>
        
      </section>

      <section id="accept-activity-inbox">
        <h3 id="x7-6-accept-activity"><span class="secno">7.6 </span>Accept Activity</h3>
        <p>
          The side effect of receiving this in an <strong>inbox</strong> is
          determined by the type of the <code>object</code> received,
          and it is possible to accept types not described in this document
          (for example, an <code>Offer</code>).
        </p>

        <p>
          If the <code>object</code> of an <code>Accept</code> received to an
          <strong>inbox</strong> is a <code>Follow</code> activity
          previously sent by the receiver, the server <em class="rfc2119" title="SHOULD">SHOULD</em> add the
          <code>actor</code> to the receiver's
          <a href="#following">Following Collection</a>.
        </p>
      </section>
      
      <section id="reject-activity-inbox">
        <h3 id="x7-7-reject-activity"><span class="secno">7.7 </span>Reject Activity</h3>
        <p>
          The side effect of receiving this in an <strong>inbox</strong> is
          determined by the type of the <code>object</code> received,
          and it is possible to reject types not described in this document
          (for example, an <code>Offer</code>).
        </p>

        <p>
          If the <code>object</code> of a <code>Reject</code> received to an
          <strong>inbox</strong> is a <code>Follow</code> activity
          previously sent by the receiver, this means the recipient did not
          approve the <code>Follow</code> request. The server <em class="rfc2119" title="MUST NOT">MUST NOT</em> add the
          <code>actor</code> to the receiver's
          <a href="#following">Following Collection</a>.
        </p>
      </section>

      <section id="add-activity-inbox">
        <h3 id="x7-8-add-activity"><span class="secno">7.8 </span>Add Activity</h3>
        <p>
          Upon receipt of an <code>Add</code> activity into the
          <strong>inbox</strong>, the server <em class="rfc2119" title="SHOULD">SHOULD</em>
          add the <code>object</code> to the collection specified in the
          <code>target</code> property, unless:
        </p>
        <ul>
          <li>
            the <code>target</code> is not owned by the receiving server, and
            thus they can't update it.
          </li>
          <li>
            the <code>object</code> is not allowed to be added to the
            <code>target</code> collection for some other reason, at the
            receiver's discretion.
          </li>
        </ul>
      </section>
      <section id="remove-activity-inbox">
        <h3 id="x7-9-remove-activity"><span class="secno">7.9 </span>Remove Activity</h3>
        <p>
          Upon receipt of a <code>Remove</code> activity into the
          <strong>inbox</strong>, the server <em class="rfc2119" title="SHOULD">SHOULD</em>
          remove the <code>object</code> from the collection specified in the
          <code>target</code> property, unless:
        </p><ul>
          <li>
            the <code>target</code> is not owned by the receiving server, and
            thus they can't update it.
          </li>
          <li>
            the <code>object</code> is not allowed to be removed to the
            <code>target</code> collection for some other reason, at the
            receiver's discretion.
          </li>
        </ul>
      </section>
      <section id="like-activity-inbox">
        <h3 id="x7-10-like-activity"><span class="secno">7.10 </span>Like Activity</h3>
        <p>
          The side effect of receiving this in an <strong>inbox</strong> is
          that the server <em class="rfc2119" title="SHOULD">SHOULD</em> increment the object's count of likes by
          adding the received activity to the
          <a href="#likes"><code>likes</code></a> collection
          if this collection is present.
        </p>
      </section>
      <section id="announce-activity-inbox">
        <h3 id="x7-11-announce-activity-sharing"><span class="secno">7.11 </span>Announce Activity (sharing)</h3>
        <p>
          Upon receipt of an <code>Announce</code> activity in an
          <strong>inbox</strong>, a server <em class="rfc2119" title="SHOULD">SHOULD</em> increment the object's count
          of shares by adding the received activity to the
          <a href="#shares"><code>shares</code></a> collection
          if this collection is present.
        </p>
        <div class="note"><div role="heading" class="note-title marker" id="h-note-12" aria-level="4"><span>Note</span></div><div class="">
          The <code>Announce</code> activity is effectively what is known as
          "sharing", "reposting", or "boosting" in other social networks.
        </div></div>
      </section>
      <section id="undo-activity-inbox">
        <h3 id="x7-12-undo-activity"><span class="secno">7.12 </span>Undo Activity</h3>
        <p>
          The <code>Undo</code> activity is used to undo the side effects
          of previous activities.
          See the ActivityStreams documentation on
          <a href="https://www.w3.org/TR/activitystreams-vocabulary/#inverse">
            Inverse Activities and "Undo"</a>.
          The scope and restrictions of the <code>Undo</code> activity
          are the same as for
          <a href="#undo-activity-outbox">
            the Undo activity in the context of client to server
            interactions</a>,
          but applied to a federated context.
        </p>
      </section>
    </section>

    <section id="i18n-concerns" class="appendix informative">
      <!--OddPage--><h2 id="a-internationalization"><span class="secno">A. </span>Internationalization</h2><p><em>This section is non-normative.</em></p>
      <p>
        Building an international base of users is important in a federated
        network.
        <a href="https://www.w3.org/TR/activitystreams-core/#naturalLanguageValues">
          ActivityStreams provides tooling for internationalization of content</a>,
        which should be used whenever possible.
        However, it can be difficult for implementations to determine which
        <a href="https://www.w3.org/TR/activitystreams-core/#defaultlangcontext">
          <code>@language</code> property</a>
        to provide for user-submitted content.
        The
        <a href="https://www.w3.org/International/"><abbr title="World Wide Web Consortium">W3C</abbr> Internationalization group</a>
        provides some
        <a href="https://www.w3.org/International/wiki/LanguageDetection">
          guidance on language detection</a>.
      </p>
    </section>

    <section id="security-considerations" class="appendix informative">
      <!--OddPage--><h2 id="b-security-considerations"><span class="secno">B. </span>Security Considerations</h2><p><em>This section is non-normative.</em></p>
      
      <section id="authorization">
        <h3 id="b-1-authentication-and-authorization"><span class="secno">B.1 </span>Authentication and Authorization</h3>
        <p>
          ActivityPub uses authentication for two purposes; first, to
          authenticate clients to servers, and secondly in federated
          implementations to authenticate servers to each other.
        </p>

        <p>
          Unfortunately at the time of standardization, there are no strongly
          agreed upon mechanisms for authentication.
          Some possible directions for authentication are laid out 
          <a href="https://www.w3.org/wiki/SocialCG/ActivityPub/Authentication_Authorization">in 
          the Social Web Community Group Authentication and 
          Authorization best practices report</a>.
        </p>

      </section>

      <section id="security-verification">
        <h3 id="b-2-verification"><span class="secno">B.2 </span>Verification</h3>
        <p>
          Servers should not trust client submitted content, and
          federated servers also should not trust content received from a server
          other than the content's origin without some form of verification.
        </p>
        <p>
          Servers should be careful to verify that new content is really posted
          by the actor that claims to be posting it, and that the actor has
          permission to update the resources it claims to.
          See also
          <a href="#obj" class="sec-ref"><span class="secno">3.</span> <span class="sec-title">Objects</span></a> and <a href="#authorization" class="sec-ref"><span class="secno">B.1</span> <span class="sec-title">Authentication and Authorization</span></a>.
        </p>
      </section>

      <section id="security-localhost">
        <h3 id="b-3-accessing-localhost-uris"><span class="secno">B.3 </span>Accessing localhost URIs</h3>
        <p>
          It is often convenient while developing to test against a process
          running on localhost.
          However, permitting requests to localhost in a production client or
          server instance can be dangerous.
          Making requests to URIs on localhost which do not require
          authorization may unintentionally access or modify resources assumed
          to be protected to be usable by localhost-only.
        </p>
        <p>
          If your ActivityPub server or client does permit making requests to
          localhost URIs for development purposes, consider making it a
          configuration option which defaults to off.
        </p>
      </section>

      <section id="security-uri-schemes">
        <h3 id="b-4-uri-schemes"><span class="secno">B.4 </span>URI Schemes</h3>
        <p>
          There are many types of URIs aside from just <code>http</code> and
          <code>https</code>.
          Some libraries which handle fetching requests at various URI schemes
          may try to be smart and reference schemes which may be undesirable,
          such as <code>file</code>.
          Client and server authors should carefully check how their libraries
          handle requests, and potentially whitelist only certain safe URI
          types, such as <code>http</code> and <code>https</code>.
        </p>
      </section>

      <section id="security-recursive-objects">
        <h3 id="b-5-recursive-objects"><span class="secno">B.5 </span>Recursive Objects</h3>
        <p>
          Servers should set a limit on how deep to recurse while resolving objects,
          or otherwise specially handle ActivityStreams objects with recursive
          references.
	  Failure to properly do so may result in denial-of-service security
	  vulnerabilities.
        </p>
      </section>

      <section id="security-spam">
        <h3 id="b-6-spam"><span class="secno">B.6 </span>Spam</h3>
        <p>
          Spam is a problem in any network, perhaps especially so in federated
          networks.
          While no specific mechanism for combating spam is provided in
          ActivityPub, it is recommended that servers filter incoming content
          both by local untrusted users and any remote users through some
          sort of spam filter.
        </p>
      </section>

      <section id="security-federation-dos">
        <h3 id="b-7-federation-denial-of-service"><span class="secno">B.7 </span>Federation denial-of-service</h3>
          <p>
            Servers should implement protections against denial-of-service
            attacks from other, federated servers.
            This can be done using, for example, some kind of ratelimiting
            mechanism.
            Servers should be especially careful to implement this protection
            around activities that involve side effects.
            Servers <em class="rfc2119" title="SHOULD">SHOULD</em> also take care not to overload servers with
            submissions, for example by using an exponential backoff strategy.
          </p>
      </section>

      <section id="security-c2s-ratelimiting">
        <h3 id="b-8-client-to-server-ratelimiting"><span class="secno">B.8 </span>Client-to-server ratelimiting</h3>
          <p>
            Servers should ratelimit API client submissions.
            This serves two purposes:
            </p><ol>
              <li>
                It prevents malicious clients from conducting
                denial-of-service attacks on the server.
              </li>
              <li>
                It ensures that the server will not distribute so many
                activities that it triggers another
                server's <a href="#security-federation-dos">denial-of-service
                protections</a>.
              </li>
            </ol>
          <p></p>
      </section>

      <section id="security-c2s-response-dos">
        <h3 id="b-9-client-to-server-response-denial-of-service"><span class="secno">B.9 </span>Client-to-server response denial-of-service</h3>
        <p>
          In order to prevent a client from being overloaded by oversized
          Collections, servers should take care to limit the size of Collection 
          pages they return to clients.
          Clients should still be prepared to limit the size of
          responses they are willing to handle in case they connect to malicious or
          compromised servers, for example by timing out and generating
          an error.
        </p>
      </section>

      <section id="security-sanitizing-content">
        <h3 id="b-10-sanitizing-content"><span class="secno">B.10 </span>Sanitizing Content</h3>
        <p>
          Any activity field being rendered for browsers (or other rich
          text enabled applications) should take care to sanitize fields
          containing markup to prevent cross site scripting attacks.
        </p>
      </section>

      <section id="security-not-displaying-bto-bcc">
        <h3 id="b-11-not-displaying-bto-and-bcc-properties"><span class="secno">B.11 </span>Not displaying bto and bcc properties</h3>
        <p>
          <code>bto</code> and <code>bcc</code> already
          <a href="#remove-bto-bcc-before-delivery">must be removed for delivery</a>,
          but servers are free to decide how to represent the object
          in their own storage systems.
          However, since <code>bto</code> and <code>bcc</code> are only intended
          to be known/seen by the original author of the object/activity,
          servers should omit these properties during display as well.
        </p>
      </section>
    </section>

    <section class="appendix informative" id="acknowledgements">
      <!--OddPage--><h2 id="c-acknowledgements"><span class="secno">C. </span>Acknowledgements</h2><p><em>This section is non-normative.</em></p>
      <p>
        This specification comes from years of hard work and experience by a
        number of communities exploring the space of federation on the web.
        In particular, much of this specification is informed by
        <a href="https://www.w3.org/community/ostatus/wiki/Main_Page">OStatus</a>
        and the
        <a href="https://github.com/pump-io/pump.io/blob/master/API.md">Pump API</a>,
        as pioneered by StatusNet (now GNU Social) and Pump.io.
        Both of those initiatives were the product of many developers' hard work,
        but more than anyone, Evan Prodromou has been a constant leader in this
        space, and it is unlikely that ActivityPub would exist in something
        resembling its current state without his hard work.
      </p>

      <p>
        Erin Shepherd built the initial version of this specification, borrowed
        from the ideas in the
        <a href="https://github.com/pump-io/pump.io/blob/master/API.md">Pump API</a>
        document, mostly as a complete rewrite of text, but sharing most of
        the primary ideas while switching from ActivityStreams 1 to
        ActivityStreams 2.
      </p>

      <p>
        Jessica Tallon and Christine Lemmer-Webber took over as editors when
        the standard moved to the <abbr title="World Wide Web Consortium">W3C</abbr> Social Working Group and did the majority
        of transition from Erin Shepherd's document to its current state as
        ActivityPub.
        Much of the document was rewritten and reorganized under the long feedback
        process of the Social Working Group.
      </p>

      <p>
        ActivityPub has been shaped by the careful input of many members in the
        <abbr title="World Wide Web Consortium">W3C</abbr> Social Working Group.
        ActivityPub especially owes a great debt to Amy Guy, who has done more
        than anyone to map the ideas across the different Social Working Group
        documents through her work on [<cite><a class="bibref" href="#bib-Social-Web-Protocols">Social-Web-Protocols</a></cite>].
        Amy also laid out the foundations for a significant refactoring of the
        ActivityPub spec while sprinting for four days with Christopher Allan
        Webber.
        These revisions lead to cleaner separation between the client to server
        and server components, along with clarity about ActivityPub's relationship
        to [<cite><a class="bibref" href="#bib-LDN">LDN</a></cite>], among many other improvements.
        Special thanks also goes to Benjamin Goering for putting together the
        implementation report template.
        We also thank mray for producing the spectacular tutorial illustrations
        (which are licensed under the same license as the rest of this
        document).
      </p>

      <p>
        Many people also helped ActivityPub along through careful review.
        In particular, thanks to:
        Aaron Parecki,
        AJ Jordan,
        Benjamin Goering,
        Caleb Langeslag,
        Elsa Balderrama,
        elf Pavlik,
        Eugen Rochko,
        Erik Wilde,
        Jason Robinson,
        Manu Sporny,
        Michael Vogel,
        Mike Macgirvin,
        nightpool,
        Puck Meerburg,
        Sandro Hawke,
        Sarven Capadisli,
        Tantek Çelik, and
        Yuri Volkov.
      </p>

      <p>
        This document is dedicated to all citizens of planet Earth.
        You deserve freedom of communication; we hope we have contributed in
        some part, however small, towards that goal and right.
      </p>
    </section>
  

<section id="references" class="appendix"><!--OddPage--><h2 id="d-references"><span class="secno">D. </span>References</h2><section id="normative-references"><h3 id="d-1-normative-references"><span class="secno">D.1 </span>Normative references</h3><dl class="bibliography"><dt id="bib-Activity-Vocabulary">[Activity-Vocabulary]</dt><dd><a href="https://www.w3.org/TR/activitystreams-vocabulary/"><cite>Activity Vocabulary</cite></a>. J. Snell. ActivityStreams Working Group. Editors Draft. URL: <a href="https://www.w3.org/TR/activitystreams-vocabulary/">https://www.w3.org/TR/activitystreams-vocabulary/</a>
</dd><dt id="bib-ActivityStreams">[ActivityStreams]</dt><dd><a href="https://www.w3.org/TR/activitystreams-core/"><cite>Activity Streams 2.0</cite></a>. J. Snell. ActivityStreams Working Group. Editors Draft. URL: <a href="https://www.w3.org/TR/activitystreams-core/">https://www.w3.org/TR/activitystreams-core/</a>
</dd><dt id="bib-JSON-LD">[JSON-LD]</dt><dd><a href="https://www.w3.org/TR/json-ld/"><cite>JSON-LD 1.0</cite></a>. Manu Sporny; Gregg Kellogg; Markus Lanthaler. W3C. 16 January 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/json-ld/">https://www.w3.org/TR/json-ld/</a>
</dd><dt id="bib-LDN">[LDN]</dt><dd><a href="https://www.w3.org/TR/ldn/"><cite>Linked Data Notifications</cite></a>. Sarven Capadisli; Amy Guy. W3C. 2 May 2017. W3C Recommendation. URL: <a href="https://www.w3.org/TR/ldn/">https://www.w3.org/TR/ldn/</a>
</dd><dt id="bib-RFC2119">[RFC2119]</dt><dd><a href="https://tools.ietf.org/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner. IETF. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
</dd><dt id="bib-RFC7231">[RFC7231]</dt><dd><a href="https://tools.ietf.org/html/rfc7231"><cite>Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</cite></a>. R. Fielding, Ed.; J. Reschke, Ed.. IETF. June 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7231">https://tools.ietf.org/html/rfc7231</a>
</dd><dt id="bib-RFC7234">[RFC7234]</dt><dd><a href="https://tools.ietf.org/html/rfc7234"><cite>Hypertext Transfer Protocol (HTTP/1.1): Caching</cite></a>. R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed.. IETF. June 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7234">https://tools.ietf.org/html/rfc7234</a>
</dd></dl></section><section id="informative-references"><h3 id="d-2-informative-references"><span class="secno">D.2 </span>Informative references</h3><dl class="bibliography"><dt id="bib-Micropub">[Micropub]</dt><dd><a href="https://www.w3.org/TR/micropub/"><cite>Micropub</cite></a>. Aaron Parecki. W3C. 23 May 2017. W3C Recommendation. URL: <a href="https://www.w3.org/TR/micropub/">https://www.w3.org/TR/micropub/</a>
</dd><dt id="bib-RFC6749">[RFC6749]</dt><dd><a href="https://tools.ietf.org/html/rfc6749"><cite>The OAuth 2.0 Authorization Framework</cite></a>. D. Hardt, Ed.. IETF. October 2012. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6749">https://tools.ietf.org/html/rfc6749</a>
</dd><dt id="bib-RFC6750">[RFC6750]</dt><dd><a href="https://tools.ietf.org/html/rfc6750"><cite>The OAuth 2.0 Authorization Framework: Bearer Token Usage</cite></a>. M. Jones; D. Hardt. IETF. October 2012. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6750">https://tools.ietf.org/html/rfc6750</a>
</dd><dt id="bib-Social-Web-Protocols">[Social-Web-Protocols]</dt><dd><a href="https://www.w3.org/TR/social-web-protocols/"><cite>Social Web Protocols</cite></a>. Amy Guy. W3C. 25 December 2017. W3C Note. URL: <a href="https://www.w3.org/TR/social-web-protocols/">https://www.w3.org/TR/social-web-protocols/</a>
</dd></dl></section></section><p role="navigation" id="back-to-top"><a href="#toc"><abbr title="Back to Top">↑</abbr></a></p><script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script></body></html>
